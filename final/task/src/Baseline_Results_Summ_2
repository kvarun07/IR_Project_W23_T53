{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1CU6TKOkx1_3gEXXuoddJ6mmziNoOumWn","timestamp":1680254104805}],"mount_file_id":"1paFT_cEW3ooFp0xd7qXd0faDs2eMqidB","authorship_tag":"ABX9TyPgkzTsJvFAAYD4krl8WDiU"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"758897e429a04781afa883c783467ce4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_659fc8d8102f447eb85e084f2b506231","IPY_MODEL_5ee8b7ecb564495ba28407c444d6c551"],"layout":"IPY_MODEL_75f90b2e4e874beb9b8bd168360a0889"}},"659fc8d8102f447eb85e084f2b506231":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)okenizer_config.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_668c19652aa94a22860916a9e10a7f9d","max":88,"min":0,"orientation":"horizontal","style":"IPY_MODEL_32293499b3514caf8fded3d9b0a00c4a","value":88}},"5ee8b7ecb564495ba28407c444d6c551":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_83f4dc8606ab424d80df3c279bd8eae4","placeholder":"​","style":"IPY_MODEL_592abaca444e4a12a826ee4c5bf31b1d","value":" 88.0/88.0 [00:02&lt;00:00, 29.7B/s]"}},"75f90b2e4e874beb9b8bd168360a0889":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"668c19652aa94a22860916a9e10a7f9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32293499b3514caf8fded3d9b0a00c4a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"83f4dc8606ab424d80df3c279bd8eae4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"592abaca444e4a12a826ee4c5bf31b1d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"aac2d081533d41b6a067862e2338ff5b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_093b7c2e455b446791128cafa26baf83","IPY_MODEL_a4df5cb2b84e49e3954b57b877117db6"],"layout":"IPY_MODEL_9f8a2b2a15ee4791a8b393e0778a7f54"}},"093b7c2e455b446791128cafa26baf83":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)lve/main/config.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_9cb1a3078e0c46968d74ab119a13a9b6","max":3094,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4132bbfc344a4750bf91efb640adf243","value":3094}},"a4df5cb2b84e49e3954b57b877117db6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_20bf906ff75c4c918509ed0c8675b777","placeholder":"​","style":"IPY_MODEL_3dc137440884439cbac86caaca2d769c","value":" 3.09k/3.09k [00:00&lt;00:00, 21.1kB/s]"}},"9f8a2b2a15ee4791a8b393e0778a7f54":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9cb1a3078e0c46968d74ab119a13a9b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4132bbfc344a4750bf91efb640adf243":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"20bf906ff75c4c918509ed0c8675b777":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3dc137440884439cbac86caaca2d769c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"77a85a638e944f6e854c90397a4d4d55":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_413fbed133464697b9b0609532848b52","IPY_MODEL_01eff1daa36e4fff84df868d2923c888"],"layout":"IPY_MODEL_285fb2d4f8cb4850a96df44cae907f90"}},"413fbed133464697b9b0609532848b52":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)ve/main/spiece.model: 100%","description_tooltip":null,"layout":"IPY_MODEL_ecddde1e699048deb434438801510d47","max":1912529,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0b812b4c8eda41cfa148d23c88f6c6ea","value":1912529}},"01eff1daa36e4fff84df868d2923c888":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3dfeccd25a544e1f8747f19927f71aaa","placeholder":"​","style":"IPY_MODEL_35be1b00951f436f9b0a4171076b7c67","value":" 1.91M/1.91M [00:01&lt;00:00, 1.12MB/s]"}},"285fb2d4f8cb4850a96df44cae907f90":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ecddde1e699048deb434438801510d47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0b812b4c8eda41cfa148d23c88f6c6ea":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"3dfeccd25a544e1f8747f19927f71aaa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35be1b00951f436f9b0a4171076b7c67":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3ea1c9d8719047e9901ca154787c538b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0baacabcd9f740fab650795092b1119e","IPY_MODEL_7cc1dfa649474a2eac42c6a93648208a"],"layout":"IPY_MODEL_e9c94a7f8a8f4a02889989d46893923d"}},"0baacabcd9f740fab650795092b1119e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)cial_tokens_map.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_a386e5b84b8e4706bee8e1ecd609ee33","max":65,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2ce4dba1bcea4a838a7fca2dfe49cd34","value":65}},"7cc1dfa649474a2eac42c6a93648208a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_190c151e1e084f1282206c95ddd59297","placeholder":"​","style":"IPY_MODEL_eb995ef71896475994a068a1a1c3d76e","value":" 65.0/65.0 [00:00&lt;00:00, 302B/s]"}},"e9c94a7f8a8f4a02889989d46893923d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a386e5b84b8e4706bee8e1ecd609ee33":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ce4dba1bcea4a838a7fca2dfe49cd34":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"190c151e1e084f1282206c95ddd59297":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eb995ef71896475994a068a1a1c3d76e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cf2c98a8e81746d9bcfcab58cfce3801":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0cb40a442b2f4197b217b73010888f5f","IPY_MODEL_63550cc69ee146e5a86561fe53b88253"],"layout":"IPY_MODEL_2e05b9cff77349678f3f5b882cdb5238"}},"0cb40a442b2f4197b217b73010888f5f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading pytorch_model.bin: 100%","description_tooltip":null,"layout":"IPY_MODEL_6005324be3d84a939d063cb8efc5f274","max":2275327883,"min":0,"orientation":"horizontal","style":"IPY_MODEL_755dc58e122449a8a20965b1dc553163","value":2275327883}},"63550cc69ee146e5a86561fe53b88253":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e6feb8d6d7e47238c5ccc7856338d94","placeholder":"​","style":"IPY_MODEL_c4ecbeff93ea4a0b82735c20b4bcef23","value":" 2.28G/2.28G [00:15&lt;00:00, 147MB/s]"}},"2e05b9cff77349678f3f5b882cdb5238":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6005324be3d84a939d063cb8efc5f274":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"755dc58e122449a8a20965b1dc553163":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"5e6feb8d6d7e47238c5ccc7856338d94":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c4ecbeff93ea4a0b82735c20b4bcef23":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"86ef47ca97664db1b8f1132686a68291":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_18056562bb96440eb7e163455e722ab2","IPY_MODEL_eb06ecf9cf024c0aa7a93fb1b755c643"],"layout":"IPY_MODEL_eee02ba68dfb46b094d7d02088d29260"}},"18056562bb96440eb7e163455e722ab2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)neration_config.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_a02c14076ee14f8ba49ed6f338edad78","max":260,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ee764a37933844a48e77a2a4106693b6","value":260}},"eb06ecf9cf024c0aa7a93fb1b755c643":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c5cb820d089b4a4289954ff5297d35c6","placeholder":"​","style":"IPY_MODEL_57a88a9e27db4eb6b88c76613c0976c8","value":" 260/260 [00:04&lt;00:00, 60.6B/s]"}},"eee02ba68dfb46b094d7d02088d29260":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a02c14076ee14f8ba49ed6f338edad78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ee764a37933844a48e77a2a4106693b6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"c5cb820d089b4a4289954ff5297d35c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57a88a9e27db4eb6b88c76613c0976c8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"48292ca5947a4a318872196f9b6552e9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1879ad2aefc0458c9a16ecf441094b6d","IPY_MODEL_ee1e4f57ed54491b85e64269aa91472f"],"layout":"IPY_MODEL_ee792ea56cee431d8472a0abe94c49c0"}},"1879ad2aefc0458c9a16ecf441094b6d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)okenizer_config.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_aee5730f240e438c980116912d5af5da","max":375,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dc1067ece0e14252b367db0c84a15400","value":375}},"ee1e4f57ed54491b85e64269aa91472f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_848ea8894f4f44feb726d47c3c512a60","placeholder":"​","style":"IPY_MODEL_7234c3036ebd42dea134feb4ca355fdc","value":" 375/375 [00:02&lt;00:00, 170B/s]"}},"ee792ea56cee431d8472a0abe94c49c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aee5730f240e438c980116912d5af5da":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc1067ece0e14252b367db0c84a15400":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"848ea8894f4f44feb726d47c3c512a60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7234c3036ebd42dea134feb4ca355fdc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8e53c3d0fc274c12bc330909f81e46ff":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ff979d596c7c497788128fd026cd0c36","IPY_MODEL_d8222aa0451742db9f84ac841beafb5e"],"layout":"IPY_MODEL_9cea911551644cf49d2d83c39d1efa01"}},"ff979d596c7c497788128fd026cd0c36":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)lve/main/config.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_a701269304434d238dba89e995681284","max":730,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b282ee64620246d8af97e5354b71fa60","value":730}},"d8222aa0451742db9f84ac841beafb5e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a77508d3d3348c4b402cc5d85d67cdb","placeholder":"​","style":"IPY_MODEL_9c2cb3a9383c44a69ecdb609d2448e3c","value":" 730/730 [00:01&lt;00:00, 449B/s]"}},"9cea911551644cf49d2d83c39d1efa01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a701269304434d238dba89e995681284":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b282ee64620246d8af97e5354b71fa60":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"4a77508d3d3348c4b402cc5d85d67cdb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c2cb3a9383c44a69ecdb609d2448e3c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b6293f78f897485e94f9bcfd6e0845c9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_40c68e02f24f4196ba784d3120dc78f0","IPY_MODEL_2de7827feb17423b94279a23a2d15b38"],"layout":"IPY_MODEL_6d01521aa3d74659a19243402841e4e9"}},"40c68e02f24f4196ba784d3120dc78f0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading spiece.model: 100%","description_tooltip":null,"layout":"IPY_MODEL_c29aefd92125433389ae1d38b3ed3e2e","max":4309802,"min":0,"orientation":"horizontal","style":"IPY_MODEL_628a96f0ef4f46938dce82ff3f43e0ab","value":4309802}},"2de7827feb17423b94279a23a2d15b38":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f51c6f0a37f64e3c9b9e244f7bf9daee","placeholder":"​","style":"IPY_MODEL_756ba3ca32b64f079a14ad83a2e56d78","value":" 4.31M/4.31M [00:01&lt;00:00, 3.41MB/s]"}},"6d01521aa3d74659a19243402841e4e9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c29aefd92125433389ae1d38b3ed3e2e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"628a96f0ef4f46938dce82ff3f43e0ab":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"f51c6f0a37f64e3c9b9e244f7bf9daee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"756ba3ca32b64f079a14ad83a2e56d78":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"693696665ff74e4e90410b39f4950d1d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3b88b840e32247d69c98fcb14bfcf03e","IPY_MODEL_d113d4e462ef495d82640ee5ca2729ab"],"layout":"IPY_MODEL_5b27221ae9c74303b5cb2ddb21678092"}},"3b88b840e32247d69c98fcb14bfcf03e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading (…)cial_tokens_map.json: 100%","description_tooltip":null,"layout":"IPY_MODEL_8725b09a2988400692d9e599a3b53449","max":65,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3849ea80f59e4a2dbed9df94d6cb613e","value":65}},"d113d4e462ef495d82640ee5ca2729ab":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_403afc7c9b1a48398d9fec484357b6b1","placeholder":"​","style":"IPY_MODEL_54ac1d17db444ddcbb8f703ec8ca1658","value":" 65.0/65.0 [42:09&lt;00:00, 38.9s/B]"}},"5b27221ae9c74303b5cb2ddb21678092":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8725b09a2988400692d9e599a3b53449":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3849ea80f59e4a2dbed9df94d6cb613e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"403afc7c9b1a48398d9fec484357b6b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"54ac1d17db444ddcbb8f703ec8ca1658":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"257fcafb94cd4c0994d8d0755ab8cc71":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bfa3c624a2254de69692e87da27c6659","IPY_MODEL_709aa68b755f4cd0a3dcbc7c39b14a47"],"layout":"IPY_MODEL_b9fd6a5a38c0460b8ada22014026da3a"}},"bfa3c624a2254de69692e87da27c6659":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"Downloading pytorch_model.bin: 100%","description_tooltip":null,"layout":"IPY_MODEL_dad304ef2dec4d5cacc48cf696b556a6","max":2329707353,"min":0,"orientation":"horizontal","style":"IPY_MODEL_00add96bbfcf4955bd7517c6476a071c","value":2329707353}},"709aa68b755f4cd0a3dcbc7c39b14a47":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_74a339fad33649d28555757331130a7f","placeholder":"​","style":"IPY_MODEL_4f96298f59774208b1650ac8b51709e8","value":" 2.33G/2.33G [00:15&lt;00:00, 147MB/s]"}},"b9fd6a5a38c0460b8ada22014026da3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dad304ef2dec4d5cacc48cf696b556a6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00add96bbfcf4955bd7517c6476a071c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":"initial"}},"74a339fad33649d28555757331130a7f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f96298f59774208b1650ac8b51709e8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["%cd '/content/drive/MyDrive/8th-semester/IR/IR_Project_W23/src'"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CaIXVlVku6Ho","executionInfo":{"status":"ok","timestamp":1681323116261,"user_tz":-330,"elapsed":734,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"478c8c58-55f1-4708-de81-309156474f5e"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/8th-semester/IR/IR_Project_W23/src\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":127688,"status":"ok","timestamp":1680256997781,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"},"user_tz":-330},"id":"l2SL0R82p8jE","outputId":"722395a6-d0ac-4421-d7f5-612441ee688b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.27.4-py3-none-any.whl (6.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.8/6.8 MB\u001b[0m \u001b[31m66.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.6/7.6 MB\u001b[0m \u001b[31m104.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.9/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.9/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: requests in /usr/local/lib/python3.9/dist-packages (from transformers) (2.27.1)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.9/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.9/dist-packages (from transformers) (23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.9/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.9/dist-packages (from transformers) (3.10.7)\n","Collecting huggingface-hub<1.0,>=0.11.0\n","  Downloading huggingface_hub-0.13.3-py3-none-any.whl (199 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m199.8/199.8 KB\u001b[0m \u001b[31m27.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.9/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers) (4.5.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.9/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.9/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.9/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.9/dist-packages (from requests->transformers) (1.26.15)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.13.3 tokenizers-0.13.2 transformers-4.27.4\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting git+https://github.com/ernie-mlg/rpunct.git\n","  Cloning https://github.com/ernie-mlg/rpunct.git to /tmp/pip-req-build-1glu061y\n","  Running command git clone --filter=blob:none --quiet https://github.com/ernie-mlg/rpunct.git /tmp/pip-req-build-1glu061y\n","  Resolved https://github.com/ernie-mlg/rpunct.git to commit 4c378cf570f05aa58c7d3dbb896b51ca2d95fde6\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting langdetect==1.0.9\n","  Downloading langdetect-1.0.9.tar.gz (981 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m981.5/981.5 KB\u001b[0m \u001b[31m27.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting pandas==1.2.4\n","  Downloading pandas-1.2.4-cp39-cp39-manylinux1_x86_64.whl (9.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m9.7/9.7 MB\u001b[0m \u001b[31m109.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting simpletransformers==0.61.4\n","  Downloading simpletransformers-0.61.4-py3-none-any.whl (213 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m213.0/213.0 KB\u001b[0m \u001b[31m27.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: six==1.16.0 in /usr/local/lib/python3.9/dist-packages (from rpunct==1.0.2) (1.16.0)\n","Collecting torch==1.8.1\n","  Downloading torch-1.8.1-cp39-cp39-manylinux1_x86_64.whl (804.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m804.1/804.1 MB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting click==7.1.2\n","  Downloading click-7.1.2-py2.py3-none-any.whl (82 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m82.8/82.8 KB\u001b[0m \u001b[31m11.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tqdm==4.49.0\n","  Downloading tqdm-4.49.0-py2.py3-none-any.whl (69 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m69.8/69.8 KB\u001b[0m \u001b[31m10.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.9/dist-packages (from pandas==1.2.4->rpunct==1.0.2) (2022.7.1)\n","Requirement already satisfied: numpy>=1.16.5 in /usr/local/lib/python3.9/dist-packages (from pandas==1.2.4->rpunct==1.0.2) (1.22.4)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.9/dist-packages (from pandas==1.2.4->rpunct==1.0.2) (2.8.2)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (1.2.2)\n","Collecting seqeval\n","  Downloading seqeval-1.2.2.tar.gz (43 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m43.6/43.6 KB\u001b[0m \u001b[31m6.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.97-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m77.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: transformers>=4.2.0 in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (4.27.4)\n","Requirement already satisfied: tokenizers in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (0.13.2)\n","Collecting streamlit\n","  Downloading streamlit-1.20.0-py2.py3-none-any.whl (9.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m9.6/9.6 MB\u001b[0m \u001b[31m111.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting wandb\n","  Downloading wandb-0.14.0-py3-none-any.whl (2.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 MB\u001b[0m \u001b[31m86.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (2.27.1)\n","Collecting tensorboardx\n","  Downloading tensorboardX-2.6-py2.py3-none-any.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 KB\u001b[0m \u001b[31m16.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: regex in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (2022.10.31)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.9/dist-packages (from simpletransformers==0.61.4->rpunct==1.0.2) (1.10.1)\n","Collecting datasets\n","  Downloading datasets-2.11.0-py3-none-any.whl (468 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m468.7/468.7 KB\u001b[0m \u001b[31m47.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.9/dist-packages (from torch==1.8.1->rpunct==1.0.2) (4.5.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.11.0 in /usr/local/lib/python3.9/dist-packages (from transformers>=4.2.0->simpletransformers==0.61.4->rpunct==1.0.2) (0.13.3)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.9/dist-packages (from transformers>=4.2.0->simpletransformers==0.61.4->rpunct==1.0.2) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.9/dist-packages (from transformers>=4.2.0->simpletransformers==0.61.4->rpunct==1.0.2) (3.10.7)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.9/dist-packages (from transformers>=4.2.0->simpletransformers==0.61.4->rpunct==1.0.2) (23.0)\n","Collecting dill<0.3.7,>=0.3.0\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 KB\u001b[0m \u001b[31m13.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.9/dist-packages (from datasets->simpletransformers==0.61.4->rpunct==1.0.2) (9.0.0)\n","Collecting datasets\n","  Downloading datasets-2.10.1-py3-none-any.whl (469 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m469.0/469.0 KB\u001b[0m \u001b[31m43.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.10.0-py3-none-any.whl (469 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m469.0/469.0 KB\u001b[0m \u001b[31m44.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.9.0-py3-none-any.whl (462 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m462.8/462.8 KB\u001b[0m \u001b[31m42.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.8.0-py3-none-any.whl (452 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m452.9/452.9 KB\u001b[0m \u001b[31m44.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.7.1-py3-none-any.whl (451 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m451.7/451.7 KB\u001b[0m \u001b[31m42.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.7.0-py3-none-any.whl (451 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m451.6/451.6 KB\u001b[0m \u001b[31m44.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.6.2-py3-none-any.whl (445 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m445.2/445.2 KB\u001b[0m \u001b[31m43.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.6.1-py3-none-any.whl (441 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m441.9/441.9 KB\u001b[0m \u001b[31m50.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.6.0-py3-none-any.whl (441 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m441.5/441.5 KB\u001b[0m \u001b[31m44.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.5.2-py3-none-any.whl (432 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m432.7/432.7 KB\u001b[0m \u001b[31m35.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.5.1-py3-none-any.whl (431 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m431.2/431.2 KB\u001b[0m \u001b[31m39.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.5.0-py3-none-any.whl (431 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m431.2/431.2 KB\u001b[0m \u001b[31m30.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.4.0-py3-none-any.whl (365 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m365.7/365.7 KB\u001b[0m \u001b[31m38.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.3.2-py3-none-any.whl (362 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m362.3/362.3 KB\u001b[0m \u001b[31m37.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.3.1-py3-none-any.whl (362 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m362.3/362.3 KB\u001b[0m \u001b[31m33.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.3.0-py3-none-any.whl (361 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m361.9/361.9 KB\u001b[0m \u001b[31m35.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.2.2-py3-none-any.whl (346 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m346.8/346.8 KB\u001b[0m \u001b[31m36.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.2.1-py3-none-any.whl (342 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m342.2/342.2 KB\u001b[0m \u001b[31m31.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.2.0-py3-none-any.whl (342 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m342.3/342.3 KB\u001b[0m \u001b[31m23.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.1.0-py3-none-any.whl (325 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m325.4/325.4 KB\u001b[0m \u001b[31m32.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-2.0.0-py3-none-any.whl (325 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m325.5/325.5 KB\u001b[0m \u001b[31m32.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.18.4-py3-none-any.whl (312 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m312.1/312.1 KB\u001b[0m \u001b[31m35.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.18.3-py3-none-any.whl (311 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.7/311.7 KB\u001b[0m \u001b[31m33.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.18.2-py3-none-any.whl (312 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m312.0/312.0 KB\u001b[0m \u001b[31m31.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.18.1-py3-none-any.whl (311 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.5/311.5 KB\u001b[0m \u001b[31m33.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.18.0-py3-none-any.whl (311 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m311.3/311.3 KB\u001b[0m \u001b[31m19.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.17.0-py3-none-any.whl (306 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m306.3/306.3 KB\u001b[0m \u001b[31m31.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.16.1-py3-none-any.whl (298 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m298.3/298.3 KB\u001b[0m \u001b[31m36.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.16.0-py3-none-any.whl (298 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m298.3/298.3 KB\u001b[0m \u001b[31m30.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.15.1-py3-none-any.whl (290 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m290.6/290.6 KB\u001b[0m \u001b[31m31.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.15.0-py3-none-any.whl (290 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m290.7/290.7 KB\u001b[0m \u001b[31m35.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.14.0-py3-none-any.whl (290 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m290.4/290.4 KB\u001b[0m \u001b[31m34.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.13.3-py3-none-any.whl (287 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m287.1/287.1 KB\u001b[0m \u001b[31m30.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.13.2-py3-none-any.whl (287 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m287.1/287.1 KB\u001b[0m \u001b[31m32.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.13.1-py3-none-any.whl (287 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m287.1/287.1 KB\u001b[0m \u001b[31m34.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.13.0-py3-none-any.whl (285 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m285.4/285.4 KB\u001b[0m \u001b[31m32.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.12.1-py3-none-any.whl (270 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m270.0/270.0 KB\u001b[0m \u001b[31m33.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.12.0-py3-none-any.whl (269 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m269.6/269.6 KB\u001b[0m \u001b[31m35.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.11.0-py3-none-any.whl (264 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m264.9/264.9 KB\u001b[0m \u001b[31m30.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess\n","  Downloading multiprocess-0.70.14-py39-none-any.whl (132 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m132.9/132.9 KB\u001b[0m \u001b[31m19.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec>=2021.05.0 in /usr/local/lib/python3.9/dist-packages (from datasets->simpletransformers==0.61.4->rpunct==1.0.2) (2023.3.0)\n","Collecting datasets\n","  Downloading datasets-1.10.2-py3-none-any.whl (542 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m542.1/542.1 KB\u001b[0m \u001b[31m51.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.10.1-py3-none-any.whl (542 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m542.1/542.1 KB\u001b[0m \u001b[31m54.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.10.0-py3-none-any.whl (542 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m542.1/542.1 KB\u001b[0m \u001b[31m61.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.9.0-py3-none-any.whl (262 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m262.3/262.3 KB\u001b[0m \u001b[31m35.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.8.0-py3-none-any.whl (237 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m237.5/237.5 KB\u001b[0m \u001b[31m28.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pyarrow<4.0.0,>=1.0.0\n","  Downloading pyarrow-3.0.0-cp39-cp39-manylinux2014_x86_64.whl (20.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m20.7/20.7 MB\u001b[0m \u001b[31m63.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting datasets\n","  Downloading datasets-1.7.0-py3-none-any.whl (234 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m234.9/234.9 KB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.6.2-py3-none-any.whl (221 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m221.8/221.8 KB\u001b[0m \u001b[31m31.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.6.1-py3-none-any.whl (220 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m220.7/220.7 KB\u001b[0m \u001b[31m24.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.6.0-py3-none-any.whl (202 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m202.2/202.2 KB\u001b[0m \u001b[31m27.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.5.0-py3-none-any.whl (192 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m192.6/192.6 KB\u001b[0m \u001b[31m25.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.4.1-py3-none-any.whl (186 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m186.8/186.8 KB\u001b[0m \u001b[31m24.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.4.0-py3-none-any.whl (186 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m186.8/186.8 KB\u001b[0m \u001b[31m12.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.3.0-py3-none-any.whl (181 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m181.1/181.1 KB\u001b[0m \u001b[31m22.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Downloading datasets-1.2.1-py3-none-any.whl (159 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m159.7/159.7 KB\u001b[0m \u001b[31m22.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting xxhash\n","  Downloading xxhash-3.2.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.2/212.2 KB\u001b[0m \u001b[31m28.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.9/dist-packages (from requests->simpletransformers==0.61.4->rpunct==1.0.2) (1.26.15)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.9/dist-packages (from requests->simpletransformers==0.61.4->rpunct==1.0.2) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.9/dist-packages (from requests->simpletransformers==0.61.4->rpunct==1.0.2) (3.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.9/dist-packages (from requests->simpletransformers==0.61.4->rpunct==1.0.2) (2022.12.7)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->simpletransformers==0.61.4->rpunct==1.0.2) (3.1.0)\n","Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.9/dist-packages (from scikit-learn->simpletransformers==0.61.4->rpunct==1.0.2) (1.1.1)\n","Collecting pympler>=0.9\n","  Downloading Pympler-1.0.1-py3-none-any.whl (164 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m164.8/164.8 KB\u001b[0m \u001b[31m25.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting semver\n","  Downloading semver-2.13.0-py2.py3-none-any.whl (12 kB)\n","Collecting watchdog\n","  Downloading watchdog-3.0.0-py3-none-manylinux2014_x86_64.whl (82 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m82.1/82.1 KB\u001b[0m \u001b[31m13.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pydeck>=0.1.dev5\n","  Downloading pydeck-0.8.0-py2.py3-none-any.whl (4.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.7/4.7 MB\u001b[0m \u001b[31m65.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tornado>=6.0.3 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (6.2)\n","Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (8.4.0)\n","Collecting blinker>=1.0.0\n","  Downloading blinker-1.5-py2.py3-none-any.whl (12 kB)\n","Requirement already satisfied: rich>=10.11.0 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (13.3.3)\n","Requirement already satisfied: altair<5,>=3.2.0 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (4.2.2)\n","Requirement already satisfied: importlib-metadata>=1.4 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (6.1.0)\n","Requirement already satisfied: protobuf<4,>=3.12 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (3.20.3)\n","Collecting gitpython!=3.1.19\n","  Downloading GitPython-3.1.31-py3-none-any.whl (184 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m184.3/184.3 KB\u001b[0m \u001b[31m25.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: cachetools>=4.0 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (5.3.0)\n","Requirement already satisfied: tzlocal>=1.1 in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (4.3)\n","Requirement already satisfied: toml in /usr/local/lib/python3.9/dist-packages (from streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.10.2)\n","Collecting validators>=0.2\n","  Downloading validators-0.20.0.tar.gz (30 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting setproctitle\n","  Downloading setproctitle-1.3.2-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (30 kB)\n","Requirement already satisfied: appdirs>=1.4.3 in /usr/local/lib/python3.9/dist-packages (from wandb->simpletransformers==0.61.4->rpunct==1.0.2) (1.4.4)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.9/dist-packages (from wandb->simpletransformers==0.61.4->rpunct==1.0.2) (67.6.1)\n","Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.9/dist-packages (from wandb->simpletransformers==0.61.4->rpunct==1.0.2) (5.9.4)\n","Collecting sentry-sdk>=1.0.0\n","  Downloading sentry_sdk-1.18.0-py2.py3-none-any.whl (194 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.8/194.8 KB\u001b[0m \u001b[31m24.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting docker-pycreds>=0.4.0\n","  Downloading docker_pycreds-0.4.0-py2.py3-none-any.whl (9.0 kB)\n","Collecting pathtools\n","  Downloading pathtools-0.1.2.tar.gz (11 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: entrypoints in /usr/local/lib/python3.9/dist-packages (from altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.4)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.9/dist-packages (from altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (3.1.2)\n","Requirement already satisfied: toolz in /usr/local/lib/python3.9/dist-packages (from altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.12.0)\n","Requirement already satisfied: jsonschema>=3.0 in /usr/local/lib/python3.9/dist-packages (from altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (4.3.3)\n","Collecting gitdb<5,>=4.0.1\n","  Downloading gitdb-4.0.10-py3-none-any.whl (62 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.7/62.7 KB\u001b[0m \u001b[31m8.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.9/dist-packages (from importlib-metadata>=1.4->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (3.15.0)\n","Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.9/dist-packages (from rich>=10.11.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (2.14.0)\n","Requirement already satisfied: markdown-it-py<3.0.0,>=2.2.0 in /usr/local/lib/python3.9/dist-packages (from rich>=10.11.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (2.2.0)\n","Requirement already satisfied: pytz-deprecation-shim in /usr/local/lib/python3.9/dist-packages (from tzlocal>=1.1->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.1.0.post0)\n","Requirement already satisfied: decorator>=3.4.0 in /usr/local/lib/python3.9/dist-packages (from validators>=0.2->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (4.4.2)\n","Collecting smmap<6,>=3.0.1\n","  Downloading smmap-5.0.0-py3-none-any.whl (24 kB)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.9/dist-packages (from jinja2->altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (2.1.2)\n","Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,>=0.14.0 in /usr/local/lib/python3.9/dist-packages (from jsonschema>=3.0->altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.19.3)\n","Requirement already satisfied: attrs>=17.4.0 in /usr/local/lib/python3.9/dist-packages (from jsonschema>=3.0->altair<5,>=3.2.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (22.2.0)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.9/dist-packages (from markdown-it-py<3.0.0,>=2.2.0->rich>=10.11.0->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (0.1.2)\n","Requirement already satisfied: tzdata in /usr/local/lib/python3.9/dist-packages (from pytz-deprecation-shim->tzlocal>=1.1->streamlit->simpletransformers==0.61.4->rpunct==1.0.2) (2023.3)\n","Building wheels for collected packages: rpunct, langdetect, seqeval, validators, pathtools\n","  Building wheel for rpunct (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for rpunct: filename=rpunct-1.0.2-py3-none-any.whl size=5953 sha256=f093516c1d3af7fda47246817a70d9004c50268aff6a6e513c917ed457bf961b\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-40ct_c9v/wheels/b5/b3/bc/c9a2b7d8cdc733f1eea8c9c5a1d16fe339c33cbd02b24579c3\n","  Building wheel for langdetect (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for langdetect: filename=langdetect-1.0.9-py3-none-any.whl size=993243 sha256=a500b9a1ff8243dfc7a4a4b598600198161797042704aa08d801745f21baf224\n","  Stored in directory: /root/.cache/pip/wheels/d1/c1/d9/7e068de779d863bc8f8fc9467d85e25cfe47fa5051fff1a1bb\n","  Building wheel for seqeval (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for seqeval: filename=seqeval-1.2.2-py3-none-any.whl size=16180 sha256=0521d6b200df5ae0e4be3597a57527bc20f710634286725486a72bb9d49c7396\n","  Stored in directory: /root/.cache/pip/wheels/e2/a5/92/2c80d1928733611c2747a9820e1324a6835524d9411510c142\n","  Building wheel for validators (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for validators: filename=validators-0.20.0-py3-none-any.whl size=19579 sha256=e51d348050c3384aa57bdd69c5cda09c57975dc9b005cd5ac689e5dd7d7da276\n","  Stored in directory: /root/.cache/pip/wheels/2d/f0/a8/1094fca7a7e5d0d12ff56e0c64675d72aa5cc81a5fc200e849\n","  Building wheel for pathtools (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pathtools: filename=pathtools-0.1.2-py3-none-any.whl size=8807 sha256=152de48b4dbe6b5f138d529e6747170f76b74fde8447af9ad002d7c3dd4e1b54\n","  Stored in directory: /root/.cache/pip/wheels/b7/0a/67/ada2a22079218c75a88361c0782855cc72aebc4d18d0289d05\n","Successfully built rpunct langdetect seqeval validators pathtools\n","Installing collected packages: sentencepiece, pathtools, xxhash, watchdog, validators, tqdm, torch, tensorboardx, smmap, setproctitle, sentry-sdk, semver, pympler, langdetect, docker-pycreds, dill, click, blinker, pydeck, pandas, multiprocess, gitdb, seqeval, gitpython, datasets, wandb, streamlit, simpletransformers, rpunct\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.65.0\n","    Uninstalling tqdm-4.65.0:\n","      Successfully uninstalled tqdm-4.65.0\n","  Attempting uninstall: torch\n","    Found existing installation: torch 1.13.1+cu116\n","    Uninstalling torch-1.13.1+cu116:\n","      Successfully uninstalled torch-1.13.1+cu116\n","  Attempting uninstall: click\n","    Found existing installation: click 8.1.3\n","    Uninstalling click-8.1.3:\n","      Successfully uninstalled click-8.1.3\n","  Attempting uninstall: pandas\n","    Found existing installation: pandas 1.4.4\n","    Uninstalling pandas-1.4.4:\n","      Successfully uninstalled pandas-1.4.4\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","yfinance 0.2.14 requires pandas>=1.3.0, but you have pandas 1.2.4 which is incompatible.\n","xarray 2022.12.0 requires pandas>=1.3, but you have pandas 1.2.4 which is incompatible.\n","torchvision 0.14.1+cu116 requires torch==1.13.1, but you have torch 1.8.1 which is incompatible.\n","torchtext 0.14.1 requires torch==1.13.1, but you have torch 1.8.1 which is incompatible.\n","torchaudio 0.13.1+cu116 requires torch==1.13.1, but you have torch 1.8.1 which is incompatible.\n","plotnine 0.10.1 requires pandas>=1.3.5, but you have pandas 1.2.4 which is incompatible.\n","mizani 0.8.1 requires pandas>=1.3.5, but you have pandas 1.2.4 which is incompatible.\n","flask 2.2.3 requires click>=8.0, but you have click 7.1.2 which is incompatible.\n","arviz 0.15.1 requires pandas>=1.3.0, but you have pandas 1.2.4 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed blinker-1.5 click-7.1.2 datasets-1.2.1 dill-0.3.6 docker-pycreds-0.4.0 gitdb-4.0.10 gitpython-3.1.31 langdetect-1.0.9 multiprocess-0.70.14 pandas-1.2.4 pathtools-0.1.2 pydeck-0.8.0 pympler-1.0.1 rpunct-1.0.2 semver-2.13.0 sentencepiece-0.1.97 sentry-sdk-1.18.0 seqeval-1.2.2 setproctitle-1.3.2 simpletransformers-0.61.4 smmap-5.0.0 streamlit-1.20.0 tensorboardx-2.6 torch-1.8.1 tqdm-4.49.0 validators-0.20.0 wandb-0.14.0 watchdog-3.0.0 xxhash-3.2.0\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting git+https://github.com/tagucci/pythonrouge.git\n","  Cloning https://github.com/tagucci/pythonrouge.git to /tmp/pip-req-build-7_fzvgew\n","  Running command git clone --filter=blob:none --quiet https://github.com/tagucci/pythonrouge.git /tmp/pip-req-build-7_fzvgew\n","  Resolved https://github.com/tagucci/pythonrouge.git to commit 0f1603dbc089ecb0fb40fdd3a28576e9f3d36769\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Building wheels for collected packages: pythonrouge\n","  Building wheel for pythonrouge (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pythonrouge: filename=pythonrouge-0.2-py3-none-any.whl size=285409 sha256=e6d5e102fe5ac2b2c0b52417345d5b49b9b190390fa53837d7f5bcdbff2cf1b9\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-ook9mi2u/wheels/c1/18/09/c2759ebb9b275e5c59db45dfa35a77dfdbdbde1a733e4427e1\n","Successfully built pythonrouge\n","Installing collected packages: pythonrouge\n","Successfully installed pythonrouge-0.2\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting rouge-metric\n","  Downloading rouge_metric-1.0.1-py3-none-any.whl (151 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m151.7/151.7 KB\u001b[0m \u001b[31m8.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: rouge-metric\n","Successfully installed rouge-metric-1.0.1\n"]}],"source":["!pip install transformers\n","!pip3 install git+https://github.com/ernie-mlg/rpunct.git\n","!pip install git+https://github.com/tagucci/pythonrouge.git\n","!pip install rouge-metric\n","from rouge_metric import PyRouge\n","# from tqdm.auto import tqdm\n","from tqdm import trange, tqdm\n","import os\n","import sys\n","import requests\n","import json\n","import pandas as pd\n","import numpy as np\n","from transformers import AutoTokenizer, AutoModelForSeq2SeqLM"]},{"cell_type":"markdown","source":["### Load data"],"metadata":{"id":"bFcio-bHB4Vh"}},{"cell_type":"code","source":["data_dir = '../data/'\n","data_list = os.listdir(data_dir)\n","print(data_list)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fr0bzGS-91VZ","executionInfo":{"status":"ok","timestamp":1680257488278,"user_tz":-330,"elapsed":1589,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"218303d2-0a4d-4889-a009-000d1910e04a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['cnn10.json', 'cnn10_full.json', 'ramsay10.json', 'ted.json', 'reviews.json', 'podcasts.json', 'summary']\n"]}]},{"cell_type":"markdown","source":["### Data: CNN Full"],"metadata":{"id":"8YyjfSr8B0Sk"}},{"cell_type":"code","source":["data_file = 'cnn10_full.json'\n","data_path = data_dir + data_file\n","data_name = data_file[:-5]\n","save_data_path = data_dir + 'summary/' + data_name + '.xlsx'\n","print(\"Data File:\", data_name)\n","df = pd.read_json(data_path)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"id":"71xtFJwYqgDn","executionInfo":{"status":"ok","timestamp":1680257492366,"user_tz":-330,"elapsed":879,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"57cdbeaa-ef1a-4639-b750-79665ce0788c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Data File: cnn10_full\n"]},{"output_type":"execute_result","data":{"text/plain":["            id                                      text_captions  \\\n","0  8GgaCgjAFLM  [music] Thank you Hello lovely people Happy! F...   \n","1  Kc_GMYHJNFQ  [music] Thank you hello everyone! Wonderful! W...   \n","2  wPdiuj2JwEU  [music] Thank you Hey there everyone Terrific!...   \n","3  H07TJT3VpSY  [music] Thank you! What's up Sunshine, Welcome...   \n","4  U4WxR7hXfCQ  [music] Thank you! What's up lovely people? Th...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","1  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","2  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","3  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","4  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","\n","                                             summary  \n","0   It's been nearly three years since the start ...  \n","1   Some farmers are not harvesting any tomatoes,...  \n","2   CNN Business Correspondent Rahel Solomon has ...  \n","3   Friday marked one year since Russian Presiden...  \n","4   Massive storm system pummeling much of the co...  "],"text/html":["\n","  <div id=\"df-4f167ef2-46bf-42b6-be33-e52c8ca151fc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text_captions</th>\n","      <th>fused_captions</th>\n","      <th>summary</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>8GgaCgjAFLM</td>\n","      <td>[music] Thank you Hello lovely people Happy! F...</td>\n","      <td>[{'text': '[Music]', 'start': 0.0, 'duration':...</td>\n","      <td>It's been nearly three years since the start ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Kc_GMYHJNFQ</td>\n","      <td>[music] Thank you hello everyone! Wonderful! W...</td>\n","      <td>[{'text': '[Music]', 'start': 0.0, 'duration':...</td>\n","      <td>Some farmers are not harvesting any tomatoes,...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>wPdiuj2JwEU</td>\n","      <td>[music] Thank you Hey there everyone Terrific!...</td>\n","      <td>[{'text': '[Music]', 'start': 0.0, 'duration':...</td>\n","      <td>CNN Business Correspondent Rahel Solomon has ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>H07TJT3VpSY</td>\n","      <td>[music] Thank you! What's up Sunshine, Welcome...</td>\n","      <td>[{'text': '[Music]', 'start': 0.0, 'duration':...</td>\n","      <td>Friday marked one year since Russian Presiden...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>U4WxR7hXfCQ</td>\n","      <td>[music] Thank you! What's up lovely people? Th...</td>\n","      <td>[{'text': '[Music]', 'start': 0.0, 'duration':...</td>\n","      <td>Massive storm system pummeling much of the co...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4f167ef2-46bf-42b6-be33-e52c8ca151fc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4f167ef2-46bf-42b6-be33-e52c8ca151fc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4f167ef2-46bf-42b6-be33-e52c8ca151fc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}]},{"cell_type":"markdown","source":["#### Summarisation"],"metadata":{"id":"UaofBBYKHKNj"}},{"cell_type":"code","source":["def summarize(tokenizer, model, text, device='cuda:0'):\n","\n","    inputs = tokenizer(text, \n","                    max_length=1024, \n","                    truncation=True,\n","                    return_tensors=\"pt\").to(device)\n","    model.to(device)\n","    summary_ids = model.generate(inputs[\"input_ids\"], max_new_tokens=120, min_length=90)\n","    summary = tokenizer.batch_decode(summary_ids, \n","                                  skip_special_tokens=True, \n","                                  clean_up_tokenization_spaces=False)\n","    return summary\n","\n","checkpoint = \"google/pegasus-large\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","# Pegasus\n","df['pegasus_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['pegasus_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","df.head()\n","\n","# MT5 \n","checkpoint = \"csebuetnlp/mT5_multilingual_XLSum\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","df['mT5_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['mT5_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","print(df.head())\n","df['pegasus_summary'].iloc[0], df['mT5_summary'].iloc[0]\n","print(df.describe())\n","\n","df.to_excel(save_data_path, index=False)"],"metadata":{"id":"MSen1wa9ryB2","colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["758897e429a04781afa883c783467ce4","659fc8d8102f447eb85e084f2b506231","5ee8b7ecb564495ba28407c444d6c551","75f90b2e4e874beb9b8bd168360a0889","668c19652aa94a22860916a9e10a7f9d","32293499b3514caf8fded3d9b0a00c4a","83f4dc8606ab424d80df3c279bd8eae4","592abaca444e4a12a826ee4c5bf31b1d","aac2d081533d41b6a067862e2338ff5b","093b7c2e455b446791128cafa26baf83","a4df5cb2b84e49e3954b57b877117db6","9f8a2b2a15ee4791a8b393e0778a7f54","9cb1a3078e0c46968d74ab119a13a9b6","4132bbfc344a4750bf91efb640adf243","20bf906ff75c4c918509ed0c8675b777","3dc137440884439cbac86caaca2d769c","77a85a638e944f6e854c90397a4d4d55","413fbed133464697b9b0609532848b52","01eff1daa36e4fff84df868d2923c888","285fb2d4f8cb4850a96df44cae907f90","ecddde1e699048deb434438801510d47","0b812b4c8eda41cfa148d23c88f6c6ea","3dfeccd25a544e1f8747f19927f71aaa","35be1b00951f436f9b0a4171076b7c67","3ea1c9d8719047e9901ca154787c538b","0baacabcd9f740fab650795092b1119e","7cc1dfa649474a2eac42c6a93648208a","e9c94a7f8a8f4a02889989d46893923d","a386e5b84b8e4706bee8e1ecd609ee33","2ce4dba1bcea4a838a7fca2dfe49cd34","190c151e1e084f1282206c95ddd59297","eb995ef71896475994a068a1a1c3d76e","cf2c98a8e81746d9bcfcab58cfce3801","0cb40a442b2f4197b217b73010888f5f","63550cc69ee146e5a86561fe53b88253","2e05b9cff77349678f3f5b882cdb5238","6005324be3d84a939d063cb8efc5f274","755dc58e122449a8a20965b1dc553163","5e6feb8d6d7e47238c5ccc7856338d94","c4ecbeff93ea4a0b82735c20b4bcef23","86ef47ca97664db1b8f1132686a68291","18056562bb96440eb7e163455e722ab2","eb06ecf9cf024c0aa7a93fb1b755c643","eee02ba68dfb46b094d7d02088d29260","a02c14076ee14f8ba49ed6f338edad78","ee764a37933844a48e77a2a4106693b6","c5cb820d089b4a4289954ff5297d35c6","57a88a9e27db4eb6b88c76613c0976c8","48292ca5947a4a318872196f9b6552e9","1879ad2aefc0458c9a16ecf441094b6d","ee1e4f57ed54491b85e64269aa91472f","ee792ea56cee431d8472a0abe94c49c0","aee5730f240e438c980116912d5af5da","dc1067ece0e14252b367db0c84a15400","848ea8894f4f44feb726d47c3c512a60","7234c3036ebd42dea134feb4ca355fdc","8e53c3d0fc274c12bc330909f81e46ff","ff979d596c7c497788128fd026cd0c36","d8222aa0451742db9f84ac841beafb5e","9cea911551644cf49d2d83c39d1efa01","a701269304434d238dba89e995681284","b282ee64620246d8af97e5354b71fa60","4a77508d3d3348c4b402cc5d85d67cdb","9c2cb3a9383c44a69ecdb609d2448e3c","b6293f78f897485e94f9bcfd6e0845c9","40c68e02f24f4196ba784d3120dc78f0","2de7827feb17423b94279a23a2d15b38","6d01521aa3d74659a19243402841e4e9","c29aefd92125433389ae1d38b3ed3e2e","628a96f0ef4f46938dce82ff3f43e0ab","f51c6f0a37f64e3c9b9e244f7bf9daee","756ba3ca32b64f079a14ad83a2e56d78","693696665ff74e4e90410b39f4950d1d","3b88b840e32247d69c98fcb14bfcf03e","d113d4e462ef495d82640ee5ca2729ab","5b27221ae9c74303b5cb2ddb21678092","8725b09a2988400692d9e599a3b53449","3849ea80f59e4a2dbed9df94d6cb613e","403afc7c9b1a48398d9fec484357b6b1","54ac1d17db444ddcbb8f703ec8ca1658","257fcafb94cd4c0994d8d0755ab8cc71","bfa3c624a2254de69692e87da27c6659","709aa68b755f4cd0a3dcbc7c39b14a47","b9fd6a5a38c0460b8ada22014026da3a","dad304ef2dec4d5cacc48cf696b556a6","00add96bbfcf4955bd7517c6476a071c","74a339fad33649d28555757331130a7f","4f96298f59774208b1650ac8b51709e8"]},"executionInfo":{"status":"ok","timestamp":1680258196202,"user_tz":-330,"elapsed":698632,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"83e98b6b-40ab-466f-b55f-a1b5e5d8abd5"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)okenizer_config.json', max=88.0, style=Pro…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"758897e429a04781afa883c783467ce4"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)lve/main/config.json', max=3094.0, style=P…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"aac2d081533d41b6a067862e2338ff5b"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)ve/main/spiece.model', max=1912529.0, styl…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"77a85a638e944f6e854c90397a4d4d55"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)cial_tokens_map.json', max=65.0, style=Pro…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3ea1c9d8719047e9901ca154787c538b"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading pytorch_model.bin', max=2275327883.0, style=P…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cf2c98a8e81746d9bcfcab58cfce3801"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)neration_config.json', max=260.0, style=Pr…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"86ef47ca97664db1b8f1132686a68291"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/86 [00:00<?, ?it/s]"]},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 86/86 [04:58<00:00,  3.47s/it]\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)okenizer_config.json', max=375.0, style=Pr…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"48292ca5947a4a318872196f9b6552e9"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)lve/main/config.json', max=730.0, style=Pr…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8e53c3d0fc274c12bc330909f81e46ff"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading spiece.model', max=4309802.0, style=ProgressS…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6293f78f897485e94f9bcfd6e0845c9"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading (…)cial_tokens_map.json', max=65.0, style=Pro…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"693696665ff74e4e90410b39f4950d1d"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:446: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading pytorch_model.bin', max=2329707353.0, style=P…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"257fcafb94cd4c0994d8d0755ab8cc71"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 86/86 [05:38<00:00,  3.94s/it]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  8GgaCgjAFLM  [music] Thank you Hello lovely people Happy! F...   \n","1  Kc_GMYHJNFQ  [music] Thank you hello everyone! Wonderful! W...   \n","2  wPdiuj2JwEU  [music] Thank you Hey there everyone Terrific!...   \n","3  H07TJT3VpSY  [music] Thank you! What's up Sunshine, Welcome...   \n","4  U4WxR7hXfCQ  [music] Thank you! What's up lovely people? Th...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","1  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","2  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","3  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","4  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","\n","                                             summary  \\\n","0   It's been nearly three years since the start ...   \n","1   Some farmers are not harvesting any tomatoes,...   \n","2   CNN Business Correspondent Rahel Solomon has ...   \n","3   Friday marked one year since Russian Presiden...   \n","4   Massive storm system pummeling much of the co...   \n","\n","                                     pegasus_summary  \\\n","0  it's been nearly three years since the pandemi...   \n","1  We're going to start with news on a vegetable ...   \n","2  We'll end with our typical 10 out of 10 story,...   \n","3  Our lead story on CNN 10 Today, the ongoing in...   \n","4  We start with continuing coverage on the inten...   \n","\n","                                         mT5_summary  \n","0  This is a full transcript of the latest report...  \n","1  This is a full transcript of the BBC's weekly ...  \n","2  This is a full transcript of The Next Frontier...  \n","3  This is a full transcript of the BBC's 10 Seco...  \n","4  This is a full transcript of Brian Todd's cove...  \n","                 id                                      text_captions  \\\n","count            86                                                 86   \n","unique           86                                                 86   \n","top     pN8hXZb-eY4  [music] Thank you Hello lovely people and welc...   \n","freq              1                                                  1   \n","\n","                                           fused_captions  \\\n","count                                                  86   \n","unique                                                 86   \n","top     [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","freq                                                    1   \n","\n","                                                  summary  \\\n","count                                                  86   \n","unique                                                 86   \n","top      CNN Business Correspondent Rahel Solomon has ...   \n","freq                                                    1   \n","\n","                                          pegasus_summary  \\\n","count                                                  86   \n","unique                                                 86   \n","top     Americans have 1.6 trillion dollars in student...   \n","freq                                                    1   \n","\n","                                              mT5_summary  \n","count                                                  86  \n","unique                                                 86  \n","top     This is a full transcript of the 10 Second Tri...  \n","freq                                                    1  \n"]}]},{"cell_type":"markdown","source":["#### Evaluation"],"metadata":{"id":"sgksESMTvjqC"}},{"cell_type":"code","source":["eval_df = pd.read_excel(save_data_path)\n","eval_df.head()\n","\n","rouge = PyRouge(rouge_n=(1, 2, 4), rouge_l=True, rouge_w=True,\n","                rouge_w_weight=1.2, rouge_s=True, rouge_su=True, skip_gap=4)\n","\n","def compute_summary_rouge(pred, gt):\n","    scores = rouge.evaluate([pred,], [[gt,],])\n","    return scores\n","\n","eval_df['pegasus_rouge']=None\n","eval_df['mT5_rouge'] = None\n","pegasus_rouge_dict = []\n","mT5_rouge_dict = []\n","\n","for i in trange(len(df)):\n","    temp = compute_summary_rouge(eval_df['pegasus_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    pegasus_rouge_dict.append(temp)\n","    eval_df['pegasus_rouge'].iloc[i] = str(temp)\n","\n","    temp = compute_summary_rouge(eval_df['mT5_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    mT5_rouge_dict.append(temp)\n","    eval_df['mT5_rouge'].iloc[i] = str(temp)\n","\n","print(eval_df.head())\n","eval_df.to_excel(save_data_path, index=False)\n","\n","pegasus_rouge_df = pd.DataFrame.from_dict(pegasus_rouge_dict)\n","\n","for column in pegasus_rouge_df:\n","    pegasus_rouge_df[column] = pegasus_rouge_df[column].apply(lambda x: x['f'])\n","\n","print(pegasus_rouge_df.head())\n","print(pegasus_rouge_df.describe())\n","\n","mT5_rouge_df = pd.DataFrame.from_dict(mT5_rouge_dict)\n","\n","for column in mT5_rouge_df:\n","    mT5_rouge_df[column] = mT5_rouge_df[column].apply(lambda x: x['f'])\n","\n","mT5_rouge_df.head()\n","mT5_rouge_df.describe()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"8pUT8XeC2Haf","executionInfo":{"status":"ok","timestamp":1680260281067,"user_tz":-330,"elapsed":8557,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"2e4de99d-8bfb-4786-e8c2-6ff2b6438679"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 86/86 [00:07<00:00, 11.21it/s]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  8GgaCgjAFLM  [music] Thank you Hello lovely people Happy! F...   \n","1  Kc_GMYHJNFQ  [music] Thank you hello everyone! Wonderful! W...   \n","2  wPdiuj2JwEU  [music] Thank you Hey there everyone Terrific!...   \n","3  H07TJT3VpSY  [music] Thank you! What's up Sunshine, Welcome...   \n","4  U4WxR7hXfCQ  [music] Thank you! What's up lovely people? Th...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","1  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","2  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","3  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","4  [{'text': '[Music]', 'start': 0.0, 'duration':...   \n","\n","                                             summary  \\\n","0   It's been nearly three years since the start ...   \n","1   Some farmers are not harvesting any tomatoes,...   \n","2   CNN Business Correspondent Rahel Solomon has ...   \n","3   Friday marked one year since Russian Presiden...   \n","4   Massive storm system pummeling much of the co...   \n","\n","                                     pegasus_summary  \\\n","0  it's been nearly three years since the pandemi...   \n","1  We're going to start with news on a vegetable ...   \n","2  We'll end with our typical 10 out of 10 story,...   \n","3  Our lead story on CNN 10 Today, the ongoing in...   \n","4  We start with continuing coverage on the inten...   \n","\n","                                         mT5_summary  \\\n","0  This is a full transcript of the latest report...   \n","1  This is a full transcript of the BBC's weekly ...   \n","2  This is a full transcript of The Next Frontier...   \n","3  This is a full transcript of the BBC's 10 Seco...   \n","4  This is a full transcript of Brian Todd's cove...   \n","\n","                                       pegasus_rouge  \\\n","0  {'rouge-1': {'r': 0.38144329896907214, 'p': 0....   \n","1  {'rouge-1': {'r': 0.2288135593220339, 'p': 0.3...   \n","2  {'rouge-1': {'r': 0.208, 'p': 0.25242718446601...   \n","3  {'rouge-1': {'r': 0.38181818181818183, 'p': 0....   \n","4  {'rouge-1': {'r': 0.2698412698412698, 'p': 0.3...   \n","\n","                                           mT5_rouge  \n","0  {'rouge-1': {'r': 0.24742268041237114, 'p': 0....  \n","1  {'rouge-1': {'r': 0.16101694915254236, 'p': 0....  \n","2  {'rouge-1': {'r': 0.144, 'p': 0.32142857142857...  \n","3  {'rouge-1': {'r': 0.10909090909090909, 'p': 0....  \n","4  {'rouge-1': {'r': 0.14285714285714285, 'p': 0....  \n","    rouge-1   rouge-2   rouge-4   rouge-l  rouge-w-1.2  rouge-s4  rouge-su4\n","0  0.368159  0.140704  0.061538  0.238806     0.098501  0.118974   0.161840\n","1  0.266010  0.059701  0.000000  0.167488     0.060721  0.056853   0.092749\n","2  0.228070  0.035398  0.000000  0.122807     0.043291  0.021622   0.056886\n","3  0.387097  0.176744  0.132701  0.248848     0.119850  0.161137   0.200000\n","4  0.288136  0.111111  0.069565  0.186441     0.075097  0.080000   0.115607\n","         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  86.000000  86.000000  86.000000  86.000000    86.000000  86.000000   \n","mean    0.337772   0.163288   0.120125   0.234491     0.099692   0.147618   \n","std     0.091204   0.118604   0.113136   0.104983     0.050202   0.112206   \n","min     0.193833   0.000000   0.000000   0.094340     0.033656   0.010762   \n","25%     0.272148   0.061947   0.012420   0.151293     0.056516   0.055266   \n","50%     0.311270   0.150836   0.103485   0.215467     0.089956   0.134016   \n","75%     0.387523   0.218976   0.183576   0.292027     0.127705   0.204516   \n","max     0.541353   0.442478   0.414414   0.482759     0.222439   0.426154   \n","\n","       rouge-su4  \n","count  86.000000  \n","mean    0.180102  \n","std     0.107845  \n","min     0.043219  \n","25%     0.093600  \n","50%     0.166124  \n","75%     0.238125  \n","max     0.446292  \n"]},{"output_type":"execute_result","data":{"text/plain":["         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  86.000000  86.000000  86.000000  86.000000    86.000000  86.000000   \n","mean    0.235222   0.053943   0.013971   0.134614     0.047813   0.042261   \n","std     0.047015   0.039651   0.030168   0.036272     0.015656   0.031883   \n","min     0.116402   0.000000   0.000000   0.063158     0.021792   0.006522   \n","25%     0.202671   0.024279   0.000000   0.111749     0.037983   0.022813   \n","50%     0.233721   0.044569   0.000000   0.129444     0.044252   0.036146   \n","75%     0.262757   0.073977   0.011544   0.155345     0.054048   0.046033   \n","max     0.356757   0.196319   0.176101   0.266667     0.118488   0.183648   \n","\n","       rouge-su4  \n","count  86.000000  \n","mean    0.075317  \n","std     0.032706  \n","min     0.025408  \n","25%     0.054046  \n","50%     0.070953  \n","75%     0.083919  \n","max     0.208768  "],"text/html":["\n","  <div id=\"df-346d3a55-4f0b-4f72-b16d-8da2a7fe8f73\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rouge-1</th>\n","      <th>rouge-2</th>\n","      <th>rouge-4</th>\n","      <th>rouge-l</th>\n","      <th>rouge-w-1.2</th>\n","      <th>rouge-s4</th>\n","      <th>rouge-su4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","      <td>86.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.235222</td>\n","      <td>0.053943</td>\n","      <td>0.013971</td>\n","      <td>0.134614</td>\n","      <td>0.047813</td>\n","      <td>0.042261</td>\n","      <td>0.075317</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.047015</td>\n","      <td>0.039651</td>\n","      <td>0.030168</td>\n","      <td>0.036272</td>\n","      <td>0.015656</td>\n","      <td>0.031883</td>\n","      <td>0.032706</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.116402</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.063158</td>\n","      <td>0.021792</td>\n","      <td>0.006522</td>\n","      <td>0.025408</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.202671</td>\n","      <td>0.024279</td>\n","      <td>0.000000</td>\n","      <td>0.111749</td>\n","      <td>0.037983</td>\n","      <td>0.022813</td>\n","      <td>0.054046</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.233721</td>\n","      <td>0.044569</td>\n","      <td>0.000000</td>\n","      <td>0.129444</td>\n","      <td>0.044252</td>\n","      <td>0.036146</td>\n","      <td>0.070953</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.262757</td>\n","      <td>0.073977</td>\n","      <td>0.011544</td>\n","      <td>0.155345</td>\n","      <td>0.054048</td>\n","      <td>0.046033</td>\n","      <td>0.083919</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>0.356757</td>\n","      <td>0.196319</td>\n","      <td>0.176101</td>\n","      <td>0.266667</td>\n","      <td>0.118488</td>\n","      <td>0.183648</td>\n","      <td>0.208768</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-346d3a55-4f0b-4f72-b16d-8da2a7fe8f73')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-346d3a55-4f0b-4f72-b16d-8da2a7fe8f73 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-346d3a55-4f0b-4f72-b16d-8da2a7fe8f73');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}]},{"cell_type":"markdown","source":["### Data: Podcasts"],"metadata":{"id":"LdkpEHgOUcyY"}},{"cell_type":"code","source":["data_file = 'podcasts.json'\n","data_path = data_dir + data_file\n","data_name = data_file[:-5]\n","save_data_path = data_dir + 'summary/' + data_name + '.xlsx'\n","print(\"Data File:\", data_name)\n","df = pd.read_json(data_path)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1680260355067,"user_tz":-330,"elapsed":1439,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"caf6bdbf-091c-4a13-a5df-2cb6cf9209f0","id":"fwVGoBDoUh1d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Data File: podcasts\n"]},{"output_type":"execute_result","data":{"text/plain":["            id                                      text_captions  \\\n","0  9V7lvEkslV4  *glass smashes.* *More Glass smashes* A: Hey E...   \n","1  VWCT8N267ss  Dan: It's time to move on to segment number tw...   \n","2  17fw6p7Z1WU  *squelch squelch squelch* Arin: Are You rollin...   \n","3  EyNnFiGmnkA  Dan: Have We begun? Arin: Welcome to the Zehn ...   \n","4  XZvPNPFKPRY  *opening music* Dan: What am I looking at? Ari...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '*Glass smashes.*', 'start': 8.52, '...   \n","1  [{'text': 'Dan: It's time to move on to segmen...   \n","2  [{'text': '*squelch squelch squelch*', 'start'...   \n","3  [{'text': 'Dan: Have we begun?\n","Arin: Welcome t...   \n","4  [{'text': '*opening music*', 'start': 4.18, 'd...   \n","\n","                                             summary  \n","0   Game Grumps 10 Minute Power Hour is unscripte...  \n","1   Dan: It's time to move on to segment number t...  \n","2   Dan's Robot: Mm SoMeThIn'In'S CoOkIn' MuSt Be...  \n","3   Dan: \"We're gonna be so fucking cute, dude. O...  \n","4   The 10 Minute Power Hour is hosted by Dan and...  "],"text/html":["\n","  <div id=\"df-af127604-5eba-4cb7-bd4e-afc473a8d82b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text_captions</th>\n","      <th>fused_captions</th>\n","      <th>summary</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>9V7lvEkslV4</td>\n","      <td>*glass smashes.* *More Glass smashes* A: Hey E...</td>\n","      <td>[{'text': '*Glass smashes.*', 'start': 8.52, '...</td>\n","      <td>Game Grumps 10 Minute Power Hour is unscripte...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>VWCT8N267ss</td>\n","      <td>Dan: It's time to move on to segment number tw...</td>\n","      <td>[{'text': 'Dan: It's time to move on to segmen...</td>\n","      <td>Dan: It's time to move on to segment number t...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>17fw6p7Z1WU</td>\n","      <td>*squelch squelch squelch* Arin: Are You rollin...</td>\n","      <td>[{'text': '*squelch squelch squelch*', 'start'...</td>\n","      <td>Dan's Robot: Mm SoMeThIn'In'S CoOkIn' MuSt Be...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>EyNnFiGmnkA</td>\n","      <td>Dan: Have We begun? Arin: Welcome to the Zehn ...</td>\n","      <td>[{'text': 'Dan: Have we begun?\n","Arin: Welcome t...</td>\n","      <td>Dan: \"We're gonna be so fucking cute, dude. O...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>XZvPNPFKPRY</td>\n","      <td>*opening music* Dan: What am I looking at? Ari...</td>\n","      <td>[{'text': '*opening music*', 'start': 4.18, 'd...</td>\n","      <td>The 10 Minute Power Hour is hosted by Dan and...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-af127604-5eba-4cb7-bd4e-afc473a8d82b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-af127604-5eba-4cb7-bd4e-afc473a8d82b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-af127604-5eba-4cb7-bd4e-afc473a8d82b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"markdown","source":["#### Summarisation"],"metadata":{"id":"VcSlSls0Uh1f"}},{"cell_type":"code","source":["def summarize(tokenizer, model, text, device='cuda:0'):\n","\n","    inputs = tokenizer(text, \n","                    max_length=1024, \n","                    truncation=True,\n","                    return_tensors=\"pt\").to(device)\n","    model.to(device)\n","    summary_ids = model.generate(inputs[\"input_ids\"], max_new_tokens=120, min_length=90)\n","    summary = tokenizer.batch_decode(summary_ids, \n","                                  skip_special_tokens=True, \n","                                  clean_up_tokenization_spaces=False)\n","    return summary\n","\n","checkpoint = \"google/pegasus-large\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","# Pegasus\n","df['pegasus_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['pegasus_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","df.head()\n","\n","# MT5 \n","checkpoint = \"csebuetnlp/mT5_multilingual_XLSum\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","df['mT5_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['mT5_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","print(df.head())\n","df['pegasus_summary'].iloc[0], df['mT5_summary'].iloc[0]\n","print(df.describe())\n","\n","df.to_excel(save_data_path, index=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1680261143323,"user_tz":-330,"elapsed":783694,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"4a57b8b5-ad40-43c4-c2e6-ca4a61959862","id":"uIMxSqkmUh1f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 93/93 [05:33<00:00,  3.58s/it]\n","/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:446: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.\n","  warnings.warn(\n","100%|██████████| 93/93 [06:40<00:00,  4.30s/it]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  9V7lvEkslV4  *glass smashes.* *More Glass smashes* A: Hey E...   \n","1  VWCT8N267ss  Dan: It's time to move on to segment number tw...   \n","2  17fw6p7Z1WU  *squelch squelch squelch* Arin: Are You rollin...   \n","3  EyNnFiGmnkA  Dan: Have We begun? Arin: Welcome to the Zehn ...   \n","4  XZvPNPFKPRY  *opening music* Dan: What am I looking at? Ari...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '*Glass smashes.*', 'start': 8.52, '...   \n","1  [{'text': 'Dan: It's time to move on to segmen...   \n","2  [{'text': '*squelch squelch squelch*', 'start'...   \n","3  [{'text': 'Dan: Have we begun?\n","Arin: Welcome t...   \n","4  [{'text': '*opening music*', 'start': 4.18, 'd...   \n","\n","                                             summary  \\\n","0   Game Grumps 10 Minute Power Hour is unscripte...   \n","1   Dan: It's time to move on to segment number t...   \n","2   Dan's Robot: Mm SoMeThIn'In'S CoOkIn' MuSt Be...   \n","3   Dan: \"We're gonna be so fucking cute, dude. O...   \n","4   The 10 Minute Power Hour is hosted by Dan and...   \n","\n","                                     pegasus_summary  \\\n","0  Welcome to the Game Grumps 10 Minute Power Hou...   \n","1  We don't- (crash sound effect) Arin: Well I Do...   \n","2  Arin: My Name's Arin and this is- Dan: And I'm...   \n","3  Dan: The 10 Minute Power Hour. Dan: I'm so goo...   \n","4  Arin: I got some smutz on me Dan: That's it, t...   \n","\n","                                         mT5_summary  \n","0  This is a full transcript of The Game Grumps 1...  \n","1  The BBC's weekly The Boss series profiles diff...  \n","2  This is a full transcript of the 10-minute Pow...  \n","3  This is a full transcript of The 10 Minute Pow...  \n","4  This is a full transcript of The 10 Minute Pow...  \n","                 id                                      text_captions  \\\n","count            93                                                 93   \n","unique           93                                                 93   \n","top     OHHDBFDg50o  Every wanted to become a hacker that is so las...   \n","freq              1                                                  1   \n","\n","                                           fused_captions  \\\n","count                                                  93   \n","unique                                                 93   \n","top     [{'text': 'welcome back to the Jurassic make o...   \n","freq                                                    1   \n","\n","                                                  summary  \\\n","count                                                  93   \n","unique                                                 93   \n","top      The 10 minute power Hour is hosted by Aaron H...   \n","freq                                                    1   \n","\n","                                          pegasus_summary  \\\n","count                                                  93   \n","unique                                                 93   \n","top     Dan: Red Leather, yellow Leathe- that one's re...   \n","freq                                                    1   \n","\n","                                              mT5_summary  \n","count                                                  93  \n","unique                                                 93  \n","top     This is a full transcript of Arin's forthcomin...  \n","freq                                                    1  \n"]}]},{"cell_type":"markdown","source":["#### Evaluation"],"metadata":{"id":"__yALIL_Uh1h"}},{"cell_type":"code","source":["eval_df = pd.read_excel(save_data_path)\n","eval_df.head()\n","\n","rouge = PyRouge(rouge_n=(1, 2, 4), rouge_l=True, rouge_w=True,\n","                rouge_w_weight=1.2, rouge_s=True, rouge_su=True, skip_gap=4)\n","\n","def compute_summary_rouge(pred, gt):\n","    scores = rouge.evaluate([pred,], [[gt,],])\n","    return scores\n","\n","eval_df['pegasus_rouge']=None\n","eval_df['mT5_rouge'] = None\n","pegasus_rouge_dict = []\n","mT5_rouge_dict = []\n","\n","for i in trange(len(df)):\n","    temp = compute_summary_rouge(eval_df['pegasus_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    pegasus_rouge_dict.append(temp)\n","    eval_df['pegasus_rouge'].iloc[i] = str(temp)\n","\n","    temp = compute_summary_rouge(eval_df['mT5_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    mT5_rouge_dict.append(temp)\n","    eval_df['mT5_rouge'].iloc[i] = str(temp)\n","\n","print(eval_df.head())\n","eval_df.to_excel(save_data_path, index=False)\n","\n","pegasus_rouge_df = pd.DataFrame.from_dict(pegasus_rouge_dict)\n","\n","for column in pegasus_rouge_df:\n","    pegasus_rouge_df[column] = pegasus_rouge_df[column].apply(lambda x: x['f'])\n","\n","print(pegasus_rouge_df.head())\n","print(pegasus_rouge_df.describe())\n","\n","mT5_rouge_df = pd.DataFrame.from_dict(mT5_rouge_dict)\n","\n","for column in mT5_rouge_df:\n","    mT5_rouge_df[column] = mT5_rouge_df[column].apply(lambda x: x['f'])\n","\n","mT5_rouge_df.head()\n","mT5_rouge_df.describe()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1680261169820,"user_tz":-330,"elapsed":5608,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"eab880d0-b2d9-4a6c-f859-69cefdf125cb","id":"IcY_k-hJUh1i"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 93/93 [00:04<00:00, 20.53it/s]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  9V7lvEkslV4  *glass smashes.* *More Glass smashes* A: Hey E...   \n","1  VWCT8N267ss  Dan: It's time to move on to segment number tw...   \n","2  17fw6p7Z1WU  *squelch squelch squelch* Arin: Are You rollin...   \n","3  EyNnFiGmnkA  Dan: Have We begun? Arin: Welcome to the Zehn ...   \n","4  XZvPNPFKPRY  *opening music* Dan: What am I looking at? Ari...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '*Glass smashes.*', 'start': 8.52, '...   \n","1  [{'text': \"Dan: It's time to move on to segmen...   \n","2  [{'text': '*squelch squelch squelch*', 'start'...   \n","3  [{'text': 'Dan: Have we begun?\\nArin: Welcome ...   \n","4  [{'text': '*opening music*', 'start': 4.18, 'd...   \n","\n","                                             summary  \\\n","0   Game Grumps 10 Minute Power Hour is unscripte...   \n","1   Dan: It's time to move on to segment number t...   \n","2   Dan's Robot: Mm SoMeThIn'In'S CoOkIn' MuSt Be...   \n","3   Dan: \"We're gonna be so fucking cute, dude. O...   \n","4   The 10 Minute Power Hour is hosted by Dan and...   \n","\n","                                     pegasus_summary  \\\n","0  Welcome to the Game Grumps 10 Minute Power Hou...   \n","1  We don't- (crash sound effect) Arin: Well I Do...   \n","2  Arin: My Name's Arin and this is- Dan: And I'm...   \n","3  Dan: The 10 Minute Power Hour. Dan: I'm so goo...   \n","4  Arin: I got some smutz on me Dan: That's it, t...   \n","\n","                                         mT5_summary  \\\n","0  This is a full transcript of The Game Grumps 1...   \n","1  The BBC's weekly The Boss series profiles diff...   \n","2  This is a full transcript of the 10-minute Pow...   \n","3  This is a full transcript of The 10 Minute Pow...   \n","4  This is a full transcript of The 10 Minute Pow...   \n","\n","                                       pegasus_rouge  \\\n","0  {'rouge-1': {'r': 0.16033755274261605, 'p': 0....   \n","1  {'rouge-1': {'r': 0.24836601307189543, 'p': 0....   \n","2  {'rouge-1': {'r': 0.15315315315315314, 'p': 0....   \n","3  {'rouge-1': {'r': 0.12149532710280374, 'p': 0....   \n","4  {'rouge-1': {'r': 0.15028901734104047, 'p': 0....   \n","\n","                                           mT5_rouge  \n","0  {'rouge-1': {'r': 0.11814345991561181, 'p': 0....  \n","1  {'rouge-1': {'r': 0.09803921568627451, 'p': 0....  \n","2  {'rouge-1': {'r': 0.0990990990990991, 'p': 0.1...  \n","3  {'rouge-1': {'r': 0.08878504672897196, 'p': 0....  \n","4  {'rouge-1': {'r': 0.1329479768786127, 'p': 0.3...  \n","    rouge-1   rouge-2   rouge-4   rouge-l  rouge-w-1.2  rouge-s4  rouge-su4\n","0  0.248366  0.085526  0.026667  0.130719     0.035046  0.064000   0.095344\n","1  0.329004  0.183406  0.160000  0.259740     0.100745  0.170667   0.197932\n","2  0.184783  0.010989  0.000000  0.086957     0.032606  0.017978   0.046642\n","3  0.185714  0.028777  0.000000  0.100000     0.026528  0.024818   0.050971\n","4  0.210526  0.065306  0.033195  0.113360     0.039101  0.041494   0.070345\n","         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  93.000000  93.000000  93.000000  93.000000    93.000000  93.000000   \n","mean    0.253109   0.096736   0.063017   0.149871     0.054945   0.082526   \n","std     0.088620   0.090000   0.081978   0.079901     0.038567   0.083443   \n","min     0.080495   0.000000   0.000000   0.053872     0.013032   0.000000   \n","25%     0.187192   0.029762   0.000000   0.094828     0.030938   0.020482   \n","50%     0.233422   0.062992   0.026667   0.120301     0.039101   0.049123   \n","75%     0.305344   0.136882   0.095238   0.190840     0.069506   0.115361   \n","max     0.485106   0.360515   0.314410   0.417021     0.223251   0.326638   \n","\n","       rouge-su4  \n","count  93.000000  \n","mean    0.111252  \n","std     0.083142  \n","min     0.018382  \n","25%     0.048744  \n","50%     0.079156  \n","75%     0.149114  \n","max     0.354136  \n"]},{"output_type":"execute_result","data":{"text/plain":["         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  93.000000  93.000000  93.000000  93.000000    93.000000  93.000000   \n","mean    0.178622   0.033181   0.003298   0.098866     0.030478   0.023139   \n","std     0.039998   0.022733   0.006784   0.023042     0.009418   0.012702   \n","min     0.095522   0.000000   0.000000   0.053731     0.012886   0.001990   \n","25%     0.147186   0.016000   0.000000   0.079787     0.023788   0.013793   \n","50%     0.180758   0.029326   0.000000   0.098214     0.029673   0.020513   \n","75%     0.203947   0.047619   0.000000   0.117647     0.035810   0.030423   \n","max     0.280000   0.129032   0.032787   0.154762     0.056887   0.075410   \n","\n","       rouge-su4  \n","count  93.000000  \n","mean    0.049593  \n","std     0.015645  \n","min     0.018182  \n","25%     0.038781  \n","50%     0.047423  \n","75%     0.059152  \n","max     0.108992  "],"text/html":["\n","  <div id=\"df-314ea698-16e8-4a54-ace6-1aa5b01c1a0d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rouge-1</th>\n","      <th>rouge-2</th>\n","      <th>rouge-4</th>\n","      <th>rouge-l</th>\n","      <th>rouge-w-1.2</th>\n","      <th>rouge-s4</th>\n","      <th>rouge-su4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","      <td>93.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.178622</td>\n","      <td>0.033181</td>\n","      <td>0.003298</td>\n","      <td>0.098866</td>\n","      <td>0.030478</td>\n","      <td>0.023139</td>\n","      <td>0.049593</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.039998</td>\n","      <td>0.022733</td>\n","      <td>0.006784</td>\n","      <td>0.023042</td>\n","      <td>0.009418</td>\n","      <td>0.012702</td>\n","      <td>0.015645</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.095522</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.053731</td>\n","      <td>0.012886</td>\n","      <td>0.001990</td>\n","      <td>0.018182</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.147186</td>\n","      <td>0.016000</td>\n","      <td>0.000000</td>\n","      <td>0.079787</td>\n","      <td>0.023788</td>\n","      <td>0.013793</td>\n","      <td>0.038781</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.180758</td>\n","      <td>0.029326</td>\n","      <td>0.000000</td>\n","      <td>0.098214</td>\n","      <td>0.029673</td>\n","      <td>0.020513</td>\n","      <td>0.047423</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.203947</td>\n","      <td>0.047619</td>\n","      <td>0.000000</td>\n","      <td>0.117647</td>\n","      <td>0.035810</td>\n","      <td>0.030423</td>\n","      <td>0.059152</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>0.280000</td>\n","      <td>0.129032</td>\n","      <td>0.032787</td>\n","      <td>0.154762</td>\n","      <td>0.056887</td>\n","      <td>0.075410</td>\n","      <td>0.108992</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-314ea698-16e8-4a54-ace6-1aa5b01c1a0d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-314ea698-16e8-4a54-ace6-1aa5b01c1a0d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-314ea698-16e8-4a54-ace6-1aa5b01c1a0d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}]},{"cell_type":"markdown","source":["### Data: Ramsay"],"metadata":{"id":"x75Vd3hAXzer"}},{"cell_type":"code","source":["data_file = 'ramsay10.json'\n","data_path = data_dir + data_file\n","data_name = data_file[:-5]\n","save_data_path = data_dir + 'summary/' + data_name + '.xlsx'\n","print(\"Data File:\", data_name)\n","df = pd.read_json(data_path)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1680261283658,"user_tz":-330,"elapsed":813,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"578f0e8a-be2a-44dd-f961-dcccfe09e79c","id":"weR-QwleYCQK"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Data File: ramsay10\n"]},{"output_type":"execute_result","data":{"text/plain":["            id                                      text_captions  \\\n","0  7cVg0hYi5io  [music] right. Guess what? Everyone in my hous...   \n","1  99ND_B5kMd4  Happy New Year Now! Come on, let's be honest, ...   \n","2  LB9KDxAOMvI  [music] Now come on, we've all got a sweet too...   \n","3  a-2n_g4AdDM  [music] Now come on, let's be honest, who does...   \n","4  tpikKCfm-kU  [music] Now, throughout my travels across Asia...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 1.83999999999999...   \n","1  [{'text': 'happy new year now come on let's be...   \n","2  [{'text': '[Music]', 'start': 1.83999999999999...   \n","3  [{'text': '[Music]', 'start': 1.83999999999999...   \n","4  [{'text': '[Music]', 'start': 1.83999999999999...   \n","\n","                                             summary  \n","0   This is an amazing cauliflower steak that wil...  \n","1   This is a beautiful flank steak and it's a bi...  \n","2   Rhubarb tarts are so easy for a Sunday brunch...  \n","3   Ramsay shows you how to make a delicious spic...  \n","4   Thai style lettuce wrap is a hodgepodge smorg...  "],"text/html":["\n","  <div id=\"df-7fc5f8b1-f992-491f-9055-42f87fcc2f1f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text_captions</th>\n","      <th>fused_captions</th>\n","      <th>summary</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>7cVg0hYi5io</td>\n","      <td>[music] right. Guess what? Everyone in my hous...</td>\n","      <td>[{'text': '[Music]', 'start': 1.83999999999999...</td>\n","      <td>This is an amazing cauliflower steak that wil...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>99ND_B5kMd4</td>\n","      <td>Happy New Year Now! Come on, let's be honest, ...</td>\n","      <td>[{'text': 'happy new year now come on let's be...</td>\n","      <td>This is a beautiful flank steak and it's a bi...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>LB9KDxAOMvI</td>\n","      <td>[music] Now come on, we've all got a sweet too...</td>\n","      <td>[{'text': '[Music]', 'start': 1.83999999999999...</td>\n","      <td>Rhubarb tarts are so easy for a Sunday brunch...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>a-2n_g4AdDM</td>\n","      <td>[music] Now come on, let's be honest, who does...</td>\n","      <td>[{'text': '[Music]', 'start': 1.83999999999999...</td>\n","      <td>Ramsay shows you how to make a delicious spic...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>tpikKCfm-kU</td>\n","      <td>[music] Now, throughout my travels across Asia...</td>\n","      <td>[{'text': '[Music]', 'start': 1.83999999999999...</td>\n","      <td>Thai style lettuce wrap is a hodgepodge smorg...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7fc5f8b1-f992-491f-9055-42f87fcc2f1f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7fc5f8b1-f992-491f-9055-42f87fcc2f1f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7fc5f8b1-f992-491f-9055-42f87fcc2f1f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}]},{"cell_type":"markdown","source":["#### Summarisation"],"metadata":{"id":"8ZHAB4PLYCQm"}},{"cell_type":"code","source":["def summarize(tokenizer, model, text, device='cuda:0'):\n","\n","    inputs = tokenizer(text, \n","                    max_length=1024, \n","                    truncation=True,\n","                    return_tensors=\"pt\").to(device)\n","    model.to(device)\n","    summary_ids = model.generate(inputs[\"input_ids\"], max_new_tokens=120, min_length=90)\n","    summary = tokenizer.batch_decode(summary_ids, \n","                                  skip_special_tokens=True, \n","                                  clean_up_tokenization_spaces=False)\n","    return summary\n","\n","checkpoint = \"google/pegasus-large\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","# Pegasus\n","df['pegasus_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['pegasus_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","df.head()\n","\n","# MT5 \n","checkpoint = \"csebuetnlp/mT5_multilingual_XLSum\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","df['mT5_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['mT5_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","print(df.head())\n","df['pegasus_summary'].iloc[0], df['mT5_summary'].iloc[0]\n","print(df.describe())\n","\n","df.to_excel(save_data_path, index=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1680261607335,"user_tz":-330,"elapsed":322210,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"2fd14c64-b3cf-4f87-f7a0-1f71470b3e68","id":"zhFZ_jKeYCQn"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 31/31 [01:52<00:00,  3.62s/it]\n","/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:446: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.\n","  warnings.warn(\n","100%|██████████| 31/31 [02:31<00:00,  4.88s/it]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  7cVg0hYi5io  [music] right. Guess what? Everyone in my hous...   \n","1  99ND_B5kMd4  Happy New Year Now! Come on, let's be honest, ...   \n","2  LB9KDxAOMvI  [music] Now come on, we've all got a sweet too...   \n","3  a-2n_g4AdDM  [music] Now come on, let's be honest, who does...   \n","4  tpikKCfm-kU  [music] Now, throughout my travels across Asia...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 1.83999999999999...   \n","1  [{'text': 'happy new year now come on let's be...   \n","2  [{'text': '[Music]', 'start': 1.83999999999999...   \n","3  [{'text': '[Music]', 'start': 1.83999999999999...   \n","4  [{'text': '[Music]', 'start': 1.83999999999999...   \n","\n","                                             summary  \\\n","0   This is an amazing cauliflower steak that wil...   \n","1   This is a beautiful flank steak and it's a bi...   \n","2   Rhubarb tarts are so easy for a Sunday brunch...   \n","3   Ramsay shows you how to make a delicious spic...   \n","4   Thai style lettuce wrap is a hodgepodge smorg...   \n","\n","                                     pegasus_summary  \\\n","0  We're going to take the steak, the center cut ...   \n","1  Come on, let's be honest, isn't this the time ...   \n","2  [music] Now come on, we've all got a sweet too...   \n","3  All of you, watch carefully because I'm going ...   \n","4  So today I'm going to show you how to make a d...   \n","\n","                                         mT5_summary  \n","0  This is an amazing cauliflower steak that will...  \n","1  This is a full transcript of Ramsey in 10 . He...  \n","2  This is a full transcript of 'Rhubarb tart' by...  \n","3  This is a full transcript of the BBC's weekly ...  \n","4  The BBC's weekly The Boss series profiles diff...  \n","                 id                                      text_captions  \\\n","count            31                                                 31   \n","unique           31                                                 31   \n","top     -dWpHngp_ug  Wright's breakfast is one of the most importan...   \n","freq              1                                                  1   \n","\n","                                           fused_captions  \\\n","count                                                  31   \n","unique                                                 31   \n","top     [{'text': 'I promise you it's gonna be in ten'...   \n","freq                                                    1   \n","\n","                                                  summary  \\\n","count                                                  31   \n","unique                                                 31   \n","top      Ramsay and Ten are being challenged to use ou...   \n","freq                                                    1   \n","\n","                                          pegasus_summary  \\\n","count                                                  31   \n","unique                                                 31   \n","top     Yeah, you've done one in ten minutes. Oh well ...   \n","freq                                                    1   \n","\n","                                              mT5_summary  \n","count                                                  31  \n","unique                                                 31  \n","top     The BBC's weekly The Boss series profiles diff...  \n","freq                                                    1  \n"]}]},{"cell_type":"markdown","source":["#### Evaluation"],"metadata":{"id":"i6-BxATKYCQo"}},{"cell_type":"code","source":["eval_df = pd.read_excel(save_data_path)\n","eval_df.head()\n","\n","rouge = PyRouge(rouge_n=(1, 2, 4), rouge_l=True, rouge_w=True,\n","                rouge_w_weight=1.2, rouge_s=True, rouge_su=True, skip_gap=4)\n","\n","def compute_summary_rouge(pred, gt):\n","    scores = rouge.evaluate([pred,], [[gt,],])\n","    return scores\n","\n","eval_df['pegasus_rouge']=None\n","eval_df['mT5_rouge'] = None\n","pegasus_rouge_dict = []\n","mT5_rouge_dict = []\n","\n","for i in trange(len(df)):\n","    temp = compute_summary_rouge(eval_df['pegasus_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    pegasus_rouge_dict.append(temp)\n","    eval_df['pegasus_rouge'].iloc[i] = str(temp)\n","\n","    temp = compute_summary_rouge(eval_df['mT5_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    mT5_rouge_dict.append(temp)\n","    eval_df['mT5_rouge'].iloc[i] = str(temp)\n","\n","print(eval_df.head())\n","eval_df.to_excel(save_data_path, index=False)\n","\n","pegasus_rouge_df = pd.DataFrame.from_dict(pegasus_rouge_dict)\n","\n","for column in pegasus_rouge_df:\n","    pegasus_rouge_df[column] = pegasus_rouge_df[column].apply(lambda x: x['f'])\n","\n","print(pegasus_rouge_df.head())\n","print(pegasus_rouge_df.describe())\n","\n","mT5_rouge_df = pd.DataFrame.from_dict(mT5_rouge_dict)\n","\n","for column in mT5_rouge_df:\n","    mT5_rouge_df[column] = mT5_rouge_df[column].apply(lambda x: x['f'])\n","\n","mT5_rouge_df.head()\n","mT5_rouge_df.describe()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1680261608585,"user_tz":-330,"elapsed":1277,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"b9f98695-edd8-4890-f878-2b3a236f4e79","id":"g9hzvP_0YCQo"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 31/31 [00:00<00:00, 40.34it/s]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  7cVg0hYi5io  [music] right. Guess what? Everyone in my hous...   \n","1  99ND_B5kMd4  Happy New Year Now! Come on, let's be honest, ...   \n","2  LB9KDxAOMvI  [music] Now come on, we've all got a sweet too...   \n","3  a-2n_g4AdDM  [music] Now come on, let's be honest, who does...   \n","4  tpikKCfm-kU  [music] Now, throughout my travels across Asia...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '[Music]', 'start': 1.83999999999999...   \n","1  [{'text': \"happy new year now come on let's be...   \n","2  [{'text': '[Music]', 'start': 1.83999999999999...   \n","3  [{'text': '[Music]', 'start': 1.83999999999999...   \n","4  [{'text': '[Music]', 'start': 1.83999999999999...   \n","\n","                                             summary  \\\n","0   This is an amazing cauliflower steak that wil...   \n","1   This is a beautiful flank steak and it's a bi...   \n","2   Rhubarb tarts are so easy for a Sunday brunch...   \n","3   Ramsay shows you how to make a delicious spic...   \n","4   Thai style lettuce wrap is a hodgepodge smorg...   \n","\n","                                     pegasus_summary  \\\n","0  We're going to take the steak, the center cut ...   \n","1  Come on, let's be honest, isn't this the time ...   \n","2  [music] Now come on, we've all got a sweet too...   \n","3  All of you, watch carefully because I'm going ...   \n","4  So today I'm going to show you how to make a d...   \n","\n","                                         mT5_summary  \\\n","0  This is an amazing cauliflower steak that will...   \n","1  This is a full transcript of Ramsey in 10 . He...   \n","2  This is a full transcript of 'Rhubarb tart' by...   \n","3  This is a full transcript of the BBC's weekly ...   \n","4  The BBC's weekly The Boss series profiles diff...   \n","\n","                                       pegasus_rouge  \\\n","0  {'rouge-1': {'r': 0.41228070175438597, 'p': 0....   \n","1  {'rouge-1': {'r': 0.2972972972972973, 'p': 0.4...   \n","2  {'rouge-1': {'r': 0.2916666666666667, 'p': 0.2...   \n","3  {'rouge-1': {'r': 0.3619047619047619, 'p': 0.4...   \n","4  {'rouge-1': {'r': 0.2785714285714286, 'p': 0.4...   \n","\n","                                           mT5_rouge  \n","0  {'rouge-1': {'r': 0.2543859649122807, 'p': 0.4...  \n","1  {'rouge-1': {'r': 0.10135135135135136, 'p': 0....  \n","2  {'rouge-1': {'r': 0.13541666666666666, 'p': 0....  \n","3  {'rouge-1': {'r': 0.22857142857142856, 'p': 0....  \n","4  {'rouge-1': {'r': 0.10714285714285714, 'p': 0....  \n","    rouge-1   rouge-2   rouge-4   rouge-l  rouge-w-1.2  rouge-s4  rouge-su4\n","0  0.437209  0.215962  0.200957  0.316279     0.144786  0.222010   0.259141\n","1  0.363636  0.166667  0.152542  0.223140     0.095494  0.167797   0.200000\n","2  0.288660  0.020833  0.000000  0.144330     0.056316  0.031915   0.075972\n","3  0.383838  0.275510  0.239583  0.303030     0.143699  0.247917   0.269896\n","4  0.340611  0.088106  0.000000  0.165939     0.055151  0.069955   0.116244\n","         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  31.000000  31.000000  31.000000  31.000000    31.000000  31.000000   \n","mean    0.358559   0.180273   0.136652   0.250131     0.113493   0.163511   \n","std     0.097193   0.127964   0.119601   0.111235     0.063013   0.117758   \n","min     0.166667   0.015444   0.000000   0.111111     0.039896   0.008696   \n","25%     0.293523   0.071754   0.033992   0.153955     0.058853   0.059164   \n","50%     0.345455   0.166667   0.119048   0.233184     0.096699   0.157714   \n","75%     0.407631   0.244651   0.203420   0.313069     0.146718   0.221299   \n","max     0.591549   0.500000   0.441176   0.521127     0.298656   0.464706   \n","\n","       rouge-su4  \n","count  31.000000  \n","mean    0.196819  \n","std     0.113178  \n","min     0.036058  \n","25%     0.096643  \n","50%     0.195446  \n","75%     0.253961  \n","max     0.485366  \n"]},{"output_type":"execute_result","data":{"text/plain":["         rouge-1    rouge-2    rouge-4    rouge-l  rouge-w-1.2   rouge-s4  \\\n","count  31.000000  31.000000  31.000000  31.000000    31.000000  31.000000   \n","mean    0.224234   0.049488   0.011478   0.132242     0.049555   0.038079   \n","std     0.053491   0.043188   0.031065   0.034733     0.017680   0.031326   \n","min     0.137255   0.000000   0.000000   0.082902     0.027987   0.003478   \n","25%     0.182512   0.016061   0.000000   0.114455     0.036069   0.019216   \n","50%     0.217195   0.038168   0.000000   0.121212     0.048701   0.029457   \n","75%     0.268487   0.073149   0.000000   0.145796     0.060007   0.047474   \n","max     0.327684   0.171429   0.152047   0.271186     0.112163   0.163743   \n","\n","       rouge-su4  \n","count  31.000000  \n","mean    0.070127  \n","std     0.033150  \n","min     0.032258  \n","25%     0.047554  \n","50%     0.062081  \n","75%     0.086754  \n","max     0.192233  "],"text/html":["\n","  <div id=\"df-1b2b4931-742d-4baa-b214-e2de89758d18\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rouge-1</th>\n","      <th>rouge-2</th>\n","      <th>rouge-4</th>\n","      <th>rouge-l</th>\n","      <th>rouge-w-1.2</th>\n","      <th>rouge-s4</th>\n","      <th>rouge-su4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","      <td>31.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.224234</td>\n","      <td>0.049488</td>\n","      <td>0.011478</td>\n","      <td>0.132242</td>\n","      <td>0.049555</td>\n","      <td>0.038079</td>\n","      <td>0.070127</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.053491</td>\n","      <td>0.043188</td>\n","      <td>0.031065</td>\n","      <td>0.034733</td>\n","      <td>0.017680</td>\n","      <td>0.031326</td>\n","      <td>0.033150</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.137255</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.082902</td>\n","      <td>0.027987</td>\n","      <td>0.003478</td>\n","      <td>0.032258</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.182512</td>\n","      <td>0.016061</td>\n","      <td>0.000000</td>\n","      <td>0.114455</td>\n","      <td>0.036069</td>\n","      <td>0.019216</td>\n","      <td>0.047554</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.217195</td>\n","      <td>0.038168</td>\n","      <td>0.000000</td>\n","      <td>0.121212</td>\n","      <td>0.048701</td>\n","      <td>0.029457</td>\n","      <td>0.062081</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.268487</td>\n","      <td>0.073149</td>\n","      <td>0.000000</td>\n","      <td>0.145796</td>\n","      <td>0.060007</td>\n","      <td>0.047474</td>\n","      <td>0.086754</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>0.327684</td>\n","      <td>0.171429</td>\n","      <td>0.152047</td>\n","      <td>0.271186</td>\n","      <td>0.112163</td>\n","      <td>0.163743</td>\n","      <td>0.192233</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1b2b4931-742d-4baa-b214-e2de89758d18')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1b2b4931-742d-4baa-b214-e2de89758d18 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1b2b4931-742d-4baa-b214-e2de89758d18');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","source":["### Data: Reviews"],"metadata":{"id":"VNnzd5l_Yn2N"}},{"cell_type":"code","source":["data_file = 'reviews.json'\n","data_path = data_dir + data_file\n","data_name = data_file[:-5]\n","save_data_path = data_dir + 'summary/' + data_name + '.xlsx'\n","print(\"Data File:\", data_name)\n","df = pd.read_json(data_path)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1680261740632,"user_tz":-330,"elapsed":1738,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"d3a1c266-f712-4943-e010-c7aafddeec5f","id":"baaC6aGBZJG9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Data File: reviews\n"]},{"output_type":"execute_result","data":{"text/plain":["            id                                      text_captions  \\\n","0  zhoTX0RRXPQ  (upbeat techno music) - Matte Black glass, alu...   \n","1  3yEP4ooj1WI  I was kind of wondering how long it would be b...   \n","2  gvqZCMGjh3s  Foreign [Music] [Applause] [Music] Look who we...   \n","3  cneoANZKBGk  (logo whirring) - Hey, what's up? MKBHD here. ...   \n","4  tmGDx9hVWwo  (upbeat music) (upbeat Music continues) - So T...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '(upbeat techno music)', 'start': 0....   \n","1  [{'text': 'I was kind of wondering how long it...   \n","2  [{'text': 'foreign', 'start': 0.48, 'duration'...   \n","3  [{'text': '(logo whirring)', 'start': 0.017, '...   \n","4  [{'text': '(upbeat music)', 'start': 0.38, 'du...   \n","\n","                                             summary  \n","0   The Samsung Galaxy S23 Ultra has a Snapdragon...  \n","1   This phone has a Snapdragon 8, Gen 2 with 8 g...  \n","2   The original homepod came out in 2018. It was...  \n","3   The base M2 Mac mini is a game changer becaus...  \n","4   Apple updated the 14 inch and 16 inch MacBook...  "],"text/html":["\n","  <div id=\"df-d9e99faf-6507-43f2-9fdd-78b8861b66e5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text_captions</th>\n","      <th>fused_captions</th>\n","      <th>summary</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>zhoTX0RRXPQ</td>\n","      <td>(upbeat techno music) - Matte Black glass, alu...</td>\n","      <td>[{'text': '(upbeat techno music)', 'start': 0....</td>\n","      <td>The Samsung Galaxy S23 Ultra has a Snapdragon...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>3yEP4ooj1WI</td>\n","      <td>I was kind of wondering how long it would be b...</td>\n","      <td>[{'text': 'I was kind of wondering how long it...</td>\n","      <td>This phone has a Snapdragon 8, Gen 2 with 8 g...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>gvqZCMGjh3s</td>\n","      <td>Foreign [Music] [Applause] [Music] Look who we...</td>\n","      <td>[{'text': 'foreign', 'start': 0.48, 'duration'...</td>\n","      <td>The original homepod came out in 2018. It was...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>cneoANZKBGk</td>\n","      <td>(logo whirring) - Hey, what's up? MKBHD here. ...</td>\n","      <td>[{'text': '(logo whirring)', 'start': 0.017, '...</td>\n","      <td>The base M2 Mac mini is a game changer becaus...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>tmGDx9hVWwo</td>\n","      <td>(upbeat music) (upbeat Music continues) - So T...</td>\n","      <td>[{'text': '(upbeat music)', 'start': 0.38, 'du...</td>\n","      <td>Apple updated the 14 inch and 16 inch MacBook...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d9e99faf-6507-43f2-9fdd-78b8861b66e5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d9e99faf-6507-43f2-9fdd-78b8861b66e5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d9e99faf-6507-43f2-9fdd-78b8861b66e5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":14}]},{"cell_type":"markdown","source":["#### Summarisation"],"metadata":{"id":"LQssCx8ZZJHZ"}},{"cell_type":"code","source":["def summarize(tokenizer, model, text, device='cuda:0'):\n","\n","    inputs = tokenizer(text, \n","                    max_length=1024, \n","                    truncation=True,\n","                    return_tensors=\"pt\").to(device)\n","    model.to(device)\n","    summary_ids = model.generate(inputs[\"input_ids\"], max_new_tokens=120, min_length=90)\n","    summary = tokenizer.batch_decode(summary_ids, \n","                                  skip_special_tokens=True, \n","                                  clean_up_tokenization_spaces=False)\n","    return summary\n","\n","checkpoint = \"google/pegasus-large\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","# Pegasus\n","df['pegasus_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['pegasus_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","df.head()\n","\n","# MT5 \n","checkpoint = \"csebuetnlp/mT5_multilingual_XLSum\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","df['mT5_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['mT5_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","print(df.head())\n","df['pegasus_summary'].iloc[0], df['mT5_summary'].iloc[0]\n","print(df.describe())\n","\n","df.to_excel(save_data_path, index=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1680262665294,"user_tz":-330,"elapsed":924669,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"e6a18cc3-873e-4c00-b3ea-73727695d805","id":"ZUjnV0ssZJHa"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 108/108 [06:33<00:00,  3.64s/it]\n","/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:446: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.\n","  warnings.warn(\n","100%|██████████| 108/108 [08:04<00:00,  4.48s/it]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  zhoTX0RRXPQ  (upbeat techno music) - Matte Black glass, alu...   \n","1  3yEP4ooj1WI  I was kind of wondering how long it would be b...   \n","2  gvqZCMGjh3s  Foreign [Music] [Applause] [Music] Look who we...   \n","3  cneoANZKBGk  (logo whirring) - Hey, what's up? MKBHD here. ...   \n","4  tmGDx9hVWwo  (upbeat music) (upbeat Music continues) - So T...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '(upbeat techno music)', 'start': 0....   \n","1  [{'text': 'I was kind of wondering how long it...   \n","2  [{'text': 'foreign', 'start': 0.48, 'duration'...   \n","3  [{'text': '(logo whirring)', 'start': 0.017, '...   \n","4  [{'text': '(upbeat music)', 'start': 0.38, 'du...   \n","\n","                                             summary  \\\n","0   The Samsung Galaxy S23 Ultra has a Snapdragon...   \n","1   This phone has a Snapdragon 8, Gen 2 with 8 g...   \n","2   The original homepod came out in 2018. It was...   \n","3   The base M2 Mac mini is a game changer becaus...   \n","4   Apple updated the 14 inch and 16 inch MacBook...   \n","\n","                                     pegasus_summary  \\\n","0  (upbeat techno music) Matte Black glass, alumi...   \n","1  Now people who have been following the industr...   \n","2  what is he talking about I think it was that s...   \n","3  So This little machine, this one right here, t...   \n","4  So This week, Apple updated the 14 inch and 16...   \n","\n","                                         mT5_summary  \n","0  This is a full transcript of the Samsung Galax...  \n","1  It's been a very long time since the first One...  \n","2  This is a full transcript of the second genera...  \n","3  This is the latest version of Apple's new Mac ...  \n","4  This is the M2 Max, Macintosh Pro, and it's a ...  \n","                 id                                      text_captions  \\\n","count           108                                                108   \n","unique          108                                                108   \n","top     QpbGctuHoMY  [music] What's up guys? I'm Phd here. You know...   \n","freq              1                                                  1   \n","\n","                                           fused_captions  \\\n","count                                                 108   \n","unique                                                108   \n","top     [{'text': '[Music]', 'start': 8.69, 'duration'...   \n","freq                                                    1   \n","\n","                                                  summary  \\\n","count                                                 108   \n","unique                                                108   \n","top      Apple updated the 14 inch and 16 inch MacBook...   \n","freq                                                    1   \n","\n","                                          pegasus_summary  \\\n","count                                                 108   \n","unique                                                108   \n","top     (intro sounds) - This Brand new smartphone fro...   \n","freq                                                    1   \n","\n","                                              mT5_summary  \n","count                                                 108  \n","unique                                                108  \n","top     Motorola's latest flagship smartphone, the Mot...  \n","freq                                                    1  \n"]}]},{"cell_type":"markdown","source":["#### Evaluation"],"metadata":{"id":"JXSNkji9ZJHb"}},{"cell_type":"code","source":["eval_df = pd.read_excel(save_data_path)\n","eval_df.head()\n","\n","rouge = PyRouge(rouge_n=(1, 2, 4), rouge_l=True, rouge_w=True,\n","                rouge_w_weight=1.2, rouge_s=True, rouge_su=True, skip_gap=4)\n","\n","def compute_summary_rouge(pred, gt):\n","    scores = rouge.evaluate([pred,], [[gt,],])\n","    return scores\n","\n","eval_df['pegasus_rouge']=None\n","eval_df['mT5_rouge'] = None\n","pegasus_rouge_dict = []\n","mT5_rouge_dict = []\n","\n","for i in trange(len(df)):\n","    temp = compute_summary_rouge(eval_df['pegasus_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    pegasus_rouge_dict.append(temp)\n","    eval_df['pegasus_rouge'].iloc[i] = str(temp)\n","\n","    temp = compute_summary_rouge(eval_df['mT5_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    mT5_rouge_dict.append(temp)\n","    eval_df['mT5_rouge'].iloc[i] = str(temp)\n","\n","print(eval_df.head())\n","eval_df.to_excel(save_data_path, index=False)\n","\n","pegasus_rouge_df = pd.DataFrame.from_dict(pegasus_rouge_dict)\n","\n","for column in pegasus_rouge_df:\n","    pegasus_rouge_df[column] = pegasus_rouge_df[column].apply(lambda x: x['f'])\n","\n","print(pegasus_rouge_df.head())\n","print(pegasus_rouge_df.describe())\n","\n","mT5_rouge_df = pd.DataFrame.from_dict(mT5_rouge_dict)\n","\n","for column in mT5_rouge_df:\n","    mT5_rouge_df[column] = mT5_rouge_df[column].apply(lambda x: x['f'])\n","\n","mT5_rouge_df.head()\n","mT5_rouge_df.describe()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1680262673920,"user_tz":-330,"elapsed":8637,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"067fe5ae-5c6f-4993-cb6d-b683a823615b","id":"5QqwSRQiZJHb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 108/108 [00:07<00:00, 13.72it/s]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  zhoTX0RRXPQ  (upbeat techno music) - Matte Black glass, alu...   \n","1  3yEP4ooj1WI  I was kind of wondering how long it would be b...   \n","2  gvqZCMGjh3s  Foreign [Music] [Applause] [Music] Look who we...   \n","3  cneoANZKBGk  (logo whirring) - Hey, what's up? MKBHD here. ...   \n","4  tmGDx9hVWwo  (upbeat music) (upbeat Music continues) - So T...   \n","\n","                                      fused_captions  \\\n","0  [{'text': '(upbeat techno music)', 'start': 0....   \n","1  [{'text': 'I was kind of wondering how long it...   \n","2  [{'text': 'foreign', 'start': 0.48, 'duration'...   \n","3  [{'text': '(logo whirring)', 'start': 0.017, '...   \n","4  [{'text': '(upbeat music)', 'start': 0.38, 'du...   \n","\n","                                             summary  \\\n","0   The Samsung Galaxy S23 Ultra has a Snapdragon...   \n","1   This phone has a Snapdragon 8, Gen 2 with 8 g...   \n","2   The original homepod came out in 2018. It was...   \n","3   The base M2 Mac mini is a game changer becaus...   \n","4   Apple updated the 14 inch and 16 inch MacBook...   \n","\n","                                     pegasus_summary  \\\n","0  (upbeat techno music) Matte Black glass, alumi...   \n","1  Now people who have been following the industr...   \n","2  what is he talking about I think it was that s...   \n","3  So This little machine, this one right here, t...   \n","4  So This week, Apple updated the 14 inch and 16...   \n","\n","                                         mT5_summary  \\\n","0  This is a full transcript of the Samsung Galax...   \n","1  It's been a very long time since the first One...   \n","2  This is a full transcript of the second genera...   \n","3  This is the latest version of Apple's new Mac ...   \n","4  This is the M2 Max, Macintosh Pro, and it's a ...   \n","\n","                                       pegasus_rouge  \\\n","0  {'rouge-1': {'r': 0.17479674796747968, 'p': 0....   \n","1  {'rouge-1': {'r': 0.2107843137254902, 'p': 0.3...   \n","2  {'rouge-1': {'r': 0.1791044776119403, 'p': 0.3...   \n","3  {'rouge-1': {'r': 0.3181818181818182, 'p': 0.6...   \n","4  {'rouge-1': {'r': 0.2413793103448276, 'p': 0.4...   \n","\n","                                           mT5_rouge  \n","0  {'rouge-1': {'r': 0.08536585365853659, 'p': 0....  \n","1  {'rouge-1': {'r': 0.10294117647058823, 'p': 0....  \n","2  {'rouge-1': {'r': 0.11940298507462686, 'p': 0....  \n","3  {'rouge-1': {'r': 0.1590909090909091, 'p': 0.4...  \n","4  {'rouge-1': {'r': 0.12643678160919541, 'p': 0....  \n","    rouge-1   rouge-2   rouge-4   rouge-l  rouge-w-1.2  rouge-s4  rouge-su4\n","0  0.266254  0.112150  0.100946  0.185759     0.059946  0.121136   0.145855\n","1  0.274760  0.025723  0.000000  0.108626     0.031383  0.028664   0.069339\n","2  0.238411  0.060000  0.040541  0.086093     0.033027  0.054054   0.084270\n","3  0.421053  0.265152  0.207692  0.315789     0.114215  0.241538   0.272379\n","4  0.309963  0.111524  0.075472  0.199262     0.066165  0.089057   0.126725\n","          rouge-1     rouge-2     rouge-4     rouge-l  rouge-w-1.2  \\\n","count  108.000000  108.000000  108.000000  108.000000   108.000000   \n","mean     0.290303    0.101061    0.062108    0.169400     0.058248   \n","std      0.080813    0.088743    0.080892    0.075977     0.034910   \n","min      0.118182    0.000000    0.000000    0.072727     0.019233   \n","25%      0.235817    0.030376    0.000000    0.114813     0.033334   \n","50%      0.271527    0.069913    0.015553    0.140111     0.045416   \n","75%      0.342368    0.145594    0.098153    0.208073     0.071060   \n","max      0.483271    0.365591    0.312727    0.391459     0.178033   \n","\n","         rouge-s4   rouge-su4  \n","count  108.000000  108.000000  \n","mean     0.091588    0.125149  \n","std      0.081057    0.079794  \n","min      0.001869    0.021739  \n","25%      0.027281    0.062390  \n","50%      0.055209    0.095116  \n","75%      0.126848    0.165330  \n","max      0.338909    0.359129  \n"]},{"output_type":"execute_result","data":{"text/plain":["          rouge-1     rouge-2     rouge-4     rouge-l  rouge-w-1.2  \\\n","count  108.000000  108.000000  108.000000  108.000000   108.000000   \n","mean     0.194568    0.038658    0.005194    0.113035     0.033098   \n","std      0.043232    0.028705    0.014991    0.030181     0.012339   \n","min      0.116208    0.000000    0.000000    0.057692     0.015409   \n","25%      0.164343    0.020070    0.000000    0.095238     0.026167   \n","50%      0.189769    0.033397    0.000000    0.109246     0.031053   \n","75%      0.216998    0.050158    0.001174    0.121956     0.037092   \n","max      0.415094    0.200000    0.116505    0.320755     0.116867   \n","\n","         rouge-s4   rouge-su4  \n","count  108.000000  108.000000  \n","mean     0.031479    0.059206  \n","std      0.022849    0.025152  \n","min      0.001980    0.029207  \n","25%      0.018333    0.044330  \n","50%      0.027305    0.055696  \n","75%      0.039508    0.069332  \n","max      0.186408    0.225806  "],"text/html":["\n","  <div id=\"df-535a195c-6da4-4275-9f2c-420c9d8986ad\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rouge-1</th>\n","      <th>rouge-2</th>\n","      <th>rouge-4</th>\n","      <th>rouge-l</th>\n","      <th>rouge-w-1.2</th>\n","      <th>rouge-s4</th>\n","      <th>rouge-su4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","      <td>108.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.194568</td>\n","      <td>0.038658</td>\n","      <td>0.005194</td>\n","      <td>0.113035</td>\n","      <td>0.033098</td>\n","      <td>0.031479</td>\n","      <td>0.059206</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.043232</td>\n","      <td>0.028705</td>\n","      <td>0.014991</td>\n","      <td>0.030181</td>\n","      <td>0.012339</td>\n","      <td>0.022849</td>\n","      <td>0.025152</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.116208</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.057692</td>\n","      <td>0.015409</td>\n","      <td>0.001980</td>\n","      <td>0.029207</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.164343</td>\n","      <td>0.020070</td>\n","      <td>0.000000</td>\n","      <td>0.095238</td>\n","      <td>0.026167</td>\n","      <td>0.018333</td>\n","      <td>0.044330</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.189769</td>\n","      <td>0.033397</td>\n","      <td>0.000000</td>\n","      <td>0.109246</td>\n","      <td>0.031053</td>\n","      <td>0.027305</td>\n","      <td>0.055696</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.216998</td>\n","      <td>0.050158</td>\n","      <td>0.001174</td>\n","      <td>0.121956</td>\n","      <td>0.037092</td>\n","      <td>0.039508</td>\n","      <td>0.069332</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>0.415094</td>\n","      <td>0.200000</td>\n","      <td>0.116505</td>\n","      <td>0.320755</td>\n","      <td>0.116867</td>\n","      <td>0.186408</td>\n","      <td>0.225806</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-535a195c-6da4-4275-9f2c-420c9d8986ad')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-535a195c-6da4-4275-9f2c-420c9d8986ad button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-535a195c-6da4-4275-9f2c-420c9d8986ad');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":16}]},{"cell_type":"markdown","source":["### Data: Ted"],"metadata":{"id":"cmImgAJsYv7z"}},{"cell_type":"code","source":["data_file = 'ted.json'\n","data_path = data_dir + data_file\n","data_name = data_file[:-5]\n","save_data_path = data_dir + 'summary/' + data_name + '.xlsx'\n","print(\"Data File:\", data_name)\n","df = pd.read_json(data_path)\n","df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1680262674716,"user_tz":-330,"elapsed":806,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"72867f56-a92b-4b19-f2f8-03b6f23a8445","id":"pN7f6nbdZOF7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Data File: ted\n"]},{"output_type":"execute_result","data":{"text/plain":["            id                                      text_captions  \\\n","0  MB5IX-np5fE  For A really long time, I had two mysteries th...   \n","1  5MuIMqhT8DM  Thank you very much. Well, I Would like to sta...   \n","2  eIho2S0ZahI  The Human voice: It's the instrument we all pl...   \n","3  Hu4Yvq-g7_Y  Translator: Viviane P. Reviewer: Amanda Chu A ...   \n","4  ON4iy8hq2hM  So When you think about a child,, a close frie...   \n","\n","                                      fused_captions  \\\n","0  [{'text': 'For a really long time,', 'start': ...   \n","1  [{'text': 'Thank you very much.', 'start': 0.8...   \n","2  [{'text': 'The human voice:', 'start': 13.96, ...   \n","3  [{'text': 'Translator: Viviane P.\n","Reviewer: Am...   \n","4  [{'text': 'So when you think about a child,\n","a ...   \n","\n","                                             summary  \n","0   The author has written a book about the cause...  \n","1   A lack of sleep will age a man by a decade in...  \n","2   The Human voice is the most powerful sound in...  \n","3   A few years ago, I began to observe something...  \n","4   One in three women and one in four men will e...  "],"text/html":["\n","  <div id=\"df-15bdcc59-7a37-4e93-90e3-1680164511c8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>text_captions</th>\n","      <th>fused_captions</th>\n","      <th>summary</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>MB5IX-np5fE</td>\n","      <td>For A really long time, I had two mysteries th...</td>\n","      <td>[{'text': 'For a really long time,', 'start': ...</td>\n","      <td>The author has written a book about the cause...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>5MuIMqhT8DM</td>\n","      <td>Thank you very much. Well, I Would like to sta...</td>\n","      <td>[{'text': 'Thank you very much.', 'start': 0.8...</td>\n","      <td>A lack of sleep will age a man by a decade in...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>eIho2S0ZahI</td>\n","      <td>The Human voice: It's the instrument we all pl...</td>\n","      <td>[{'text': 'The human voice:', 'start': 13.96, ...</td>\n","      <td>The Human voice is the most powerful sound in...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Hu4Yvq-g7_Y</td>\n","      <td>Translator: Viviane P. Reviewer: Amanda Chu A ...</td>\n","      <td>[{'text': 'Translator: Viviane P.\n","Reviewer: Am...</td>\n","      <td>A few years ago, I began to observe something...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ON4iy8hq2hM</td>\n","      <td>So When you think about a child,, a close frie...</td>\n","      <td>[{'text': 'So when you think about a child,\n","a ...</td>\n","      <td>One in three women and one in four men will e...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-15bdcc59-7a37-4e93-90e3-1680164511c8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-15bdcc59-7a37-4e93-90e3-1680164511c8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-15bdcc59-7a37-4e93-90e3-1680164511c8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":17}]},{"cell_type":"markdown","source":["#### Summarisation"],"metadata":{"id":"P6MNZOcIZOF9"}},{"cell_type":"code","source":["def summarize(tokenizer, model, text, device='cuda:0'):\n","\n","    inputs = tokenizer(text, \n","                    max_length=1024, \n","                    truncation=True,\n","                    return_tensors=\"pt\").to(device)\n","    model.to(device)\n","    summary_ids = model.generate(inputs[\"input_ids\"], max_new_tokens=120, min_length=90)\n","    summary = tokenizer.batch_decode(summary_ids, \n","                                  skip_special_tokens=True, \n","                                  clean_up_tokenization_spaces=False)\n","    return summary\n","\n","checkpoint = \"google/pegasus-large\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","# Pegasus\n","df['pegasus_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['pegasus_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","df.head()\n","\n","# MT5 \n","checkpoint = \"csebuetnlp/mT5_multilingual_XLSum\"\n","tokenizer = AutoTokenizer.from_pretrained(checkpoint)\n","model = AutoModelForSeq2SeqLM.from_pretrained(checkpoint)\n","\n","df['mT5_summary'] = \"\"\n","for i in trange(len(df)):\n","    df['mT5_summary'].iloc[i] = summarize(tokenizer, model, df['text_captions'].iloc[i])[0]\n","\n","print(df.head())\n","df['pegasus_summary'].iloc[0], df['mT5_summary'].iloc[0]\n","print(df.describe())\n","\n","df.to_excel(save_data_path, index=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1680263651727,"user_tz":-330,"elapsed":977020,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"aeab2d5f-0b67-44a9-cd6c-027be3fb114f","id":"RrwDIpn6ZOF9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 117/117 [06:59<00:00,  3.59s/it]\n","/usr/local/lib/python3.9/dist-packages/transformers/convert_slow_tokenizer.py:446: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.\n","  warnings.warn(\n","100%|██████████| 117/117 [08:28<00:00,  4.34s/it]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  MB5IX-np5fE  For A really long time, I had two mysteries th...   \n","1  5MuIMqhT8DM  Thank you very much. Well, I Would like to sta...   \n","2  eIho2S0ZahI  The Human voice: It's the instrument we all pl...   \n","3  Hu4Yvq-g7_Y  Translator: Viviane P. Reviewer: Amanda Chu A ...   \n","4  ON4iy8hq2hM  So When you think about a child,, a close frie...   \n","\n","                                      fused_captions  \\\n","0  [{'text': 'For a really long time,', 'start': ...   \n","1  [{'text': 'Thank you very much.', 'start': 0.8...   \n","2  [{'text': 'The human voice:', 'start': 13.96, ...   \n","3  [{'text': 'Translator: Viviane P.\n","Reviewer: Am...   \n","4  [{'text': 'So when you think about a child,\n","a ...   \n","\n","                                             summary  \\\n","0   The author has written a book about the cause...   \n","1   A lack of sleep will age a man by a decade in...   \n","2   The Human voice is the most powerful sound in...   \n","3   A few years ago, I began to observe something...   \n","4   One in three women and one in four men will e...   \n","\n","                                     pegasus_summary  \\\n","0  The First mystery was, I'm 40 years old, and a...   \n","1  (Laughter) Men Who sleep five hours a night ha...   \n","2  It's the only one that can start a war or say ...   \n","3  I Started the day with the thing that woke me ...   \n","4  It can be subtle things, like guilting a frien...   \n","\n","                                         mT5_summary  \n","0  In our series of letters from African journali...  \n","1  In our series of letters from African journali...  \n","2  The Human voice is the most powerful sound in ...  \n","3  The BBC's weekly The Boss series profiles diff...  \n","4  Love is a very important part of our lives, ac...  \n","                 id                                      text_captions  \\\n","count           117                                                117   \n","unique          117                                                117   \n","top     jOJLx4Du3vU  We are all trapped inside our own heads, and o...   \n","freq              1                                                  1   \n","\n","                                           fused_captions  \\\n","count                                                 117   \n","unique                                                117   \n","top     [{'text': 'Seven years ago, a student came to ...   \n","freq                                                    1   \n","\n","                                                  summary  \\\n","count                                                 117   \n","unique                                                117   \n","top      Psychologist: Dr. Philippe Rochat and I desig...   \n","freq                                                    1   \n","\n","                                          pegasus_summary  \\\n","count                                                 117   \n","unique                                                117   \n","top     It's actually a spectrum of disorders, a spect...   \n","freq                                                    1   \n","\n","                                              mT5_summary  \n","count                                                 117  \n","unique                                                117  \n","top     In our series of letters from African journali...  \n","freq                                                    1  \n"]}]},{"cell_type":"markdown","source":["#### Evaluation"],"metadata":{"id":"vQgE-bK7ZOF-"}},{"cell_type":"code","source":["eval_df = pd.read_excel(save_data_path)\n","eval_df.head()\n","\n","rouge = PyRouge(rouge_n=(1, 2, 4), rouge_l=True, rouge_w=True,\n","                rouge_w_weight=1.2, rouge_s=True, rouge_su=True, skip_gap=4)\n","\n","def compute_summary_rouge(pred, gt):\n","    scores = rouge.evaluate([pred,], [[gt,],])\n","    return scores\n","\n","eval_df['pegasus_rouge']=None\n","eval_df['mT5_rouge'] = None\n","pegasus_rouge_dict = []\n","mT5_rouge_dict = []\n","\n","for i in trange(len(df)):\n","    temp = compute_summary_rouge(eval_df['pegasus_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    pegasus_rouge_dict.append(temp)\n","    eval_df['pegasus_rouge'].iloc[i] = str(temp)\n","\n","    temp = compute_summary_rouge(eval_df['mT5_summary'].iloc[i], eval_df['summary'].iloc[i])\n","    mT5_rouge_dict.append(temp)\n","    eval_df['mT5_rouge'].iloc[i] = str(temp)\n","\n","print(eval_df.head())\n","eval_df.to_excel(save_data_path, index=False)\n","\n","pegasus_rouge_df = pd.DataFrame.from_dict(pegasus_rouge_dict)\n","\n","for column in pegasus_rouge_df:\n","    pegasus_rouge_df[column] = pegasus_rouge_df[column].apply(lambda x: x['f'])\n","\n","print(pegasus_rouge_df.head())\n","print(pegasus_rouge_df.describe())\n","\n","mT5_rouge_df = pd.DataFrame.from_dict(mT5_rouge_dict)\n","\n","for column in mT5_rouge_df:\n","    mT5_rouge_df[column] = mT5_rouge_df[column].apply(lambda x: x['f'])\n","\n","mT5_rouge_df.head()\n","mT5_rouge_df.describe()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1680263658333,"user_tz":-330,"elapsed":6189,"user":{"displayName":"Varun Khurana","userId":"03340191987943165154"}},"outputId":"ce810839-486a-48ca-e9e9-8edefd927498","id":"fIvGqmuqZOF_"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 117/117 [00:05<00:00, 20.63it/s]\n"]},{"output_type":"stream","name":"stdout","text":["            id                                      text_captions  \\\n","0  MB5IX-np5fE  For A really long time, I had two mysteries th...   \n","1  5MuIMqhT8DM  Thank you very much. Well, I Would like to sta...   \n","2  eIho2S0ZahI  The Human voice: It's the instrument we all pl...   \n","3  Hu4Yvq-g7_Y  Translator: Viviane P. Reviewer: Amanda Chu A ...   \n","4  ON4iy8hq2hM  So When you think about a child,, a close frie...   \n","\n","                                      fused_captions  \\\n","0  [{'text': 'For a really long time,', 'start': ...   \n","1  [{'text': 'Thank you very much.', 'start': 0.8...   \n","2  [{'text': 'The human voice:', 'start': 13.96, ...   \n","3  [{'text': 'Translator: Viviane P.\\nReviewer: A...   \n","4  [{'text': 'So when you think about a child,\\na...   \n","\n","                                             summary  \\\n","0   The author has written a book about the cause...   \n","1   A lack of sleep will age a man by a decade in...   \n","2   The Human voice is the most powerful sound in...   \n","3   A few years ago, I began to observe something...   \n","4   One in three women and one in four men will e...   \n","\n","                                     pegasus_summary  \\\n","0  The First mystery was, I'm 40 years old, and a...   \n","1  (Laughter) Men Who sleep five hours a night ha...   \n","2  It's the only one that can start a war or say ...   \n","3  I Started the day with the thing that woke me ...   \n","4  It can be subtle things, like guilting a frien...   \n","\n","                                         mT5_summary  \\\n","0  In our series of letters from African journali...   \n","1  In our series of letters from African journali...   \n","2  The Human voice is the most powerful sound in ...   \n","3  The BBC's weekly The Boss series profiles diff...   \n","4  Love is a very important part of our lives, ac...   \n","\n","                                       pegasus_rouge  \\\n","0  {'rouge-1': {'r': 0.12440191387559808, 'p': 0....   \n","1  {'rouge-1': {'r': 0.14682539682539683, 'p': 0....   \n","2  {'rouge-1': {'r': 0.3988439306358382, 'p': 0.7...   \n","3  {'rouge-1': {'r': 0.2074688796680498, 'p': 0.4...   \n","4  {'rouge-1': {'r': 0.22162162162162163, 'p': 0....   \n","\n","                                           mT5_rouge  \n","0  {'rouge-1': {'r': 0.09090909090909091, 'p': 0....  \n","1  {'rouge-1': {'r': 0.10714285714285714, 'p': 0....  \n","2  {'rouge-1': {'r': 0.27167630057803466, 'p': 0....  \n","3  {'rouge-1': {'r': 0.1078838174273859, 'p': 0.4...  \n","4  {'rouge-1': {'r': 0.15135135135135136, 'p': 0....  \n","    rouge-1   rouge-2   rouge-4   rouge-l  rouge-w-1.2  rouge-s4  rouge-su4\n","0  0.201161  0.046602  0.000000  0.104449     0.022341  0.043836   0.069707\n","1  0.212644  0.040462  0.000000  0.114943     0.029012  0.031579   0.062257\n","2  0.509225  0.356877  0.301887  0.428044     0.160601  0.330566   0.361355\n","3  0.288184  0.034783  0.000000  0.132565     0.034886  0.032845   0.075122\n","4  0.294964  0.094203  0.051471  0.122302     0.045034  0.088235   0.123472\n","          rouge-1     rouge-2     rouge-4     rouge-l  rouge-w-1.2  \\\n","count  117.000000  117.000000  117.000000  117.000000   117.000000   \n","mean     0.243997    0.081883    0.053246    0.146733     0.051019   \n","std      0.089391    0.094831    0.083311    0.085233     0.045184   \n","min      0.124224    0.000000    0.000000    0.067073     0.017160   \n","25%      0.175758    0.014440    0.000000    0.090909     0.025980   \n","50%      0.214797    0.035242    0.000000    0.111498     0.031145   \n","75%      0.294964    0.123862    0.084416    0.174807     0.058674   \n","max      0.563218    0.412500    0.371795    0.493827     0.275973   \n","\n","         rouge-s4   rouge-su4  \n","count  117.000000  117.000000  \n","mean     0.076537    0.104846  \n","std      0.086269    0.085999  \n","min      0.003571    0.028693  \n","25%      0.017582    0.044879  \n","50%      0.033208    0.067064  \n","75%      0.106422    0.136306  \n","max      0.389744    0.416996  \n"]},{"output_type":"execute_result","data":{"text/plain":["          rouge-1     rouge-2     rouge-4     rouge-l  rouge-w-1.2  \\\n","count  117.000000  117.000000  117.000000  117.000000   117.000000   \n","mean     0.183026    0.037452    0.012174    0.108336     0.031869   \n","std      0.045021    0.037614    0.025774    0.032981     0.013603   \n","min      0.092105    0.000000    0.000000    0.057018     0.012245   \n","25%      0.152439    0.013115    0.000000    0.084507     0.022756   \n","50%      0.177049    0.024691    0.000000    0.097561     0.026690   \n","75%      0.214925    0.045326    0.010929    0.127517     0.036688   \n","max      0.374502    0.240964    0.155102    0.262948     0.092537   \n","\n","         rouge-s4   rouge-su4  \n","count  117.000000  117.000000  \n","mean     0.032954    0.058466  \n","std      0.028751    0.029624  \n","min      0.003524    0.022929  \n","25%      0.015652    0.039735  \n","50%      0.023410    0.050874  \n","75%      0.040467    0.068670  \n","max      0.200816    0.229308  "],"text/html":["\n","  <div id=\"df-370b9768-61d4-4134-b92f-c7c0f844d3af\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rouge-1</th>\n","      <th>rouge-2</th>\n","      <th>rouge-4</th>\n","      <th>rouge-l</th>\n","      <th>rouge-w-1.2</th>\n","      <th>rouge-s4</th>\n","      <th>rouge-su4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>count</th>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","      <td>117.000000</td>\n","    </tr>\n","    <tr>\n","      <th>mean</th>\n","      <td>0.183026</td>\n","      <td>0.037452</td>\n","      <td>0.012174</td>\n","      <td>0.108336</td>\n","      <td>0.031869</td>\n","      <td>0.032954</td>\n","      <td>0.058466</td>\n","    </tr>\n","    <tr>\n","      <th>std</th>\n","      <td>0.045021</td>\n","      <td>0.037614</td>\n","      <td>0.025774</td>\n","      <td>0.032981</td>\n","      <td>0.013603</td>\n","      <td>0.028751</td>\n","      <td>0.029624</td>\n","    </tr>\n","    <tr>\n","      <th>min</th>\n","      <td>0.092105</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.057018</td>\n","      <td>0.012245</td>\n","      <td>0.003524</td>\n","      <td>0.022929</td>\n","    </tr>\n","    <tr>\n","      <th>25%</th>\n","      <td>0.152439</td>\n","      <td>0.013115</td>\n","      <td>0.000000</td>\n","      <td>0.084507</td>\n","      <td>0.022756</td>\n","      <td>0.015652</td>\n","      <td>0.039735</td>\n","    </tr>\n","    <tr>\n","      <th>50%</th>\n","      <td>0.177049</td>\n","      <td>0.024691</td>\n","      <td>0.000000</td>\n","      <td>0.097561</td>\n","      <td>0.026690</td>\n","      <td>0.023410</td>\n","      <td>0.050874</td>\n","    </tr>\n","    <tr>\n","      <th>75%</th>\n","      <td>0.214925</td>\n","      <td>0.045326</td>\n","      <td>0.010929</td>\n","      <td>0.127517</td>\n","      <td>0.036688</td>\n","      <td>0.040467</td>\n","      <td>0.068670</td>\n","    </tr>\n","    <tr>\n","      <th>max</th>\n","      <td>0.374502</td>\n","      <td>0.240964</td>\n","      <td>0.155102</td>\n","      <td>0.262948</td>\n","      <td>0.092537</td>\n","      <td>0.200816</td>\n","      <td>0.229308</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-370b9768-61d4-4134-b92f-c7c0f844d3af')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-370b9768-61d4-4134-b92f-c7c0f844d3af button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-370b9768-61d4-4134-b92f-c7c0f844d3af');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":[],"metadata":{"id":"1q1UFysRYtrk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"lRJwHeaEEZmf"},"execution_count":null,"outputs":[]}]}